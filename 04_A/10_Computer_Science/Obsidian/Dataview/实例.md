---
tags:
  - Obsidian
---

# Important

# Dataview

## 1. æŸ¥æ‰¾æœ€è¿‘ä¸‰å¤©ä¿®æ”¹çš„æ–‡ä»¶ï¼Œå¹¶ä¸”è®©æœ€æ–°çš„æ–‡ä»¶æ”¾åœ¨å‰é¢

```
Table file.ctime as "åˆ›å»ºæ—¥æœŸ"
Where date(today) - file.mtime <= dur(3 day) # ä»Šå¤©çš„æ—¥æœŸå‡å»åˆ›å»ºæ–‡ä»¶çš„æ—¥æœŸå°äºç­‰äºä¸‰å¤©çš„æ–‡ä»¶
Sort file.mtime desc
```

## 2. å±•ç¤ºç¬”è®°æ€»æ•°

````
```dataview
list without id "ç¬”è®°åº“ä¸­å…±æœ‰ ==" +length(rows) + "== ä¸ªé¡µé¢ï¼Œæ€»è®¡çº¦" + round(sum(rows.file.size)/10000,0) + "ä¸‡å­—èŠ‚ï¼ˆ ==" + round((sum(rows.file.size)/1048576), 2) + "MB== ï¼‰" group by 12345
```
````

# DataviewJS

## 1. [ä½¿ç”¨dataviewåˆ›å»ºæ—¥æœŸå‰©ä½™å€’è®¡æ—¶ä¸è¿›åº¦æ¡](https://forum-zh.obsidian.md/t/topic/15176)

### 1.1. æºä»£ç 

```
const nldates = app.plugins.getPlugin("nldates-obsidian")
const today = nldates.parseDate("today").moment
const week =  nldates.parseDate("next week").moment
const month = nldates.parseDate("next month").moment
const year = nldates.parseDate("next year").moment
const weekDiff = week.diff(today,'days')
const weekPercentage = parseInt(weekDiff/7*100)
const monthDiff = month.diff(today,'days')
const daysInMonth = today.daysInMonth()
const monthPercentage = parseInt(monthDiff/daysInMonth*100)
const yearDiff = year.diff(today,'days')
const yearPercentage = parseInt(yearDiff/365*100)
dv.el('div','æœ¬å‘¨è¿˜å‰©<span class="stress">'+weekDiff+'</span>å¤©')
dv.el('progress',null,{attr:{max:7,value:weekDiff,percentage:weekDiff}})
dv.el('div','æœ¬æœˆè¿˜å‰©<span class="stress">'+monthDiff+'</span>å¤©')
dv.el('progress',null,{attr:{max:daysInMonth,value:monthDiff,percentage:monthPercentage}})
dv.el('div','ä»Šå¹´è¿˜å‰©<span class="stress">'+yearDiff+'</span>å¤©')
dv.el('progress',null,{attr:{max:365,value:yearDiff,percentage:yearPercentage}})
```
### 1.2. `1.0.0`

- ä¼˜åŒ–
	- æ—¶é—´è¿›åº¦å¡ç‰‡åŒ–

````
```dataviewjs
// ä¼˜åŒ–äº†æ—¶é—´è®¡ç®—é€»è¾‘ï¼Œå¢åŠ å¼‚å¸¸å¤„ç†
dv.paragraph("# ğŸ—“ï¸ æ—¶é—´è¿›åº¦");
const nldates = app.plugins.getPlugin("nldates-obsidian");
const today = nldates.parseDate("today").moment.startOf('day');
const weekEnd = today.clone().endOf('isoWeek');
const monthEnd = today.clone().endOf('month');
const yearEnd = today.clone().endOf('year');

const weekDiff = weekEnd.diff(today, 'days') + 1;
const monthDiff = monthEnd.diff(today, 'days') + 1;
const yearDiff = yearEnd.diff(today, 'days') + 1;

const renderProgress = (value, max) => {
    const percentage = Math.round((value / max) * 100);
    return `<div class="time-progress">
        <progress value="${value}" max="${max}"></progress>
        <div class="progress-labels">
            <span>${value}å¤©</span>
            <span>${percentage}%</span>
        </div>
    </div>`;
};

dv.el('div', `
<div class="time-container">
    <div class="time-item">
        <div class="time-title">æœ¬å‘¨å‰©ä½™</div>
        ${renderProgress(weekDiff, 7)}
    </div>
    <div class="time-item">
        <div class="time-title">æœ¬æœˆå‰©ä½™</div>
        ${renderProgress(monthDiff, today.daysInMonth())}
    </div>
    <div class="time-item">
        <div class="time-title">ä»Šå¹´å‰©ä½™</div>
        ${renderProgress(yearDiff, today.isLeapYear() ? 366 : 365)}
    </div>
</div>
`);

// æ ·å¼ä¼˜åŒ–
const style = dv.container.createEl('style');
style.textContent = `
.time-container {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1.5rem;
    margin: 1rem 0;
}
.time-item {
    background: var(--background-secondary);
    padding: 1rem;
    border-radius: 8px;
}
.time-title {
    font-size: 0.9em;
    color: var(--text-muted);
    margin-bottom: 0.5rem;
}
.time-progress progress {
    width: 100%;
    height: 8px;
    border-radius: 4px;
}
.progress-labels {
    display: flex;
    justify-content: space-between;
    margin-top: 0.5rem;
    font-size: 0.85em;
    color: var(--text-muted);
}
`;
```
````

## 2. ç®¡ç†æ”¶é›†ç®±"00_Inbox"

### 2.1. `1.0.0`

````
```dataviewjs
// åˆ é™¤é‡å¤çš„Inboxæ¨¡å—ï¼Œåªä¿ç•™ä¸€ä¸ª
dv.paragraph("# ğŸ“¥ å¾…å¤„ç†ç®±");
const inboxPages = dv.pages('"00_Inbox"').values;
const today = moment();

const sortedInbox = inboxPages.sort((a, b) => {
    const aDays = today.diff(moment(Number(a.file.ctime)), 'days');
    const bDays = today.diff(moment(Number(b.file.ctime)), 'days');
    return bDays - aDays;
});

dv.paragraph(`å¾…å¤„ç†ç¬”è®°å…± ==${inboxPages.length}== ç¯‡`);

dv.list(
    sortedInbox.map(p => {
        const created = moment(Number(p.file.ctime));
        const daysOld = today.diff(created, 'days');
        return `[[${p.file.name}|ğŸ“Œ ${p.file.name}]] <span class="inbox-days">(${daysOld}å¤©æœªå¤„ç†)</span>`;
    })
);

// æ·»åŠ ç»Ÿä¸€æ ·å¼
const css = dv.container.createEl('style');
css.textContent += `
.inbox-days {
    font-size: 0.8em;
    color: var(--text-muted);
    margin-left: 8px;
}
`;
```
````

### 2.2. `1.0.1`

- ä¼˜åŒ–
	- åˆå¹¶æ ·å¼+å¢å¼ºäº¤äº’

````
```dataviewjs
dv.paragraph("# ğŸ“¥ å¾…å¤„ç†ç®±");
const inboxPages = dv.pages('"00_Inbox"').values;

// ä¿®æ­£æ—¶é—´å¤„ç†é€»è¾‘
const now = Date.now();
const getDaysOld = (timestamp) => 
    Math.floor((now - timestamp) / (1000 * 60 * 60 * 24));

dv.paragraph(`å¾…å¤„ç†ç¬”è®°å…± ==${inboxPages.length}== ç¯‡`);

dv.list(
    inboxPages
    .sort(a => a.file.ctime, "desc")
    .map(p => {
        // ä½¿ç”¨æ–‡ä»¶åˆ›å»ºæ—¶é—´æˆ³ï¼ˆå…¼å®¹Obsidian v1.3+ï¼‰
        const created = new Date(p.file.ctime);
        const daysOld = getDaysOld(p.file.ctime);
        const statusIcon = daysOld > 7 ? "ğŸ”´" : daysOld > 3 ? "ğŸŸ¡" : "ğŸŸ¢";
        return `[[${p.file.name}|${statusIcon} ${p.file.name}]] <span class="inbox-meta">åˆ›å»ºäº${created.toLocaleDateString('zh-CN')}</span>`;
    })
);

// æ·»åŠ å…¼å®¹æ€§æ ·å¼
const css = dv.container.createEl('style');
css.textContent = `
.inbox-meta {
    font-size: 0.85em;
    color: var(--text-faint);
    margin-left: 8px;
    font-family: var(--font-monospace);
}
`;
```
````

### 2.3. `1.1.0`

- å¢åŠ äº¤äº’æ€§å’Œè§†è§‰æ•ˆæœ

````
```dataviewjs
dv.paragraph("# Tasks");

// è·å–æ‰€æœ‰é¡¹ç›®çš„æœªå®Œæˆä»»åŠ¡
const allTasks = dv.pages('"01_P"').file.tasks
    .where(t => !t.completed);

// æŒ‰é¡¹ç›®åˆ†ç»„
const tasksByProject = {};
allTasks.forEach(task => {
    const project = task.path.split('/')[1]; // å‡è®¾è·¯å¾„æ ¼å¼ä¸º 01_P/é¡¹ç›®å/...
    if (!tasksByProject[project]) {
        tasksByProject[project] = [];
    }
    tasksByProject[project].push(task);
});

// åˆ›å»ºè‡ªå®šä¹‰ä»»åŠ¡åˆ—è¡¨å®¹å™¨
const container = dv.el("div", "", {cls: "custom-tasks-container"});

// éå†æ¯ä¸ªé¡¹ç›®åˆ›å»ºåˆ†ç»„
for (const [project, tasks] of Object.entries(tasksByProject)) {
    // åˆ›å»ºé¡¹ç›®æ ‡é¢˜
    container.createEl("h3", {text: ` ğŸ“ ${project} (${tasks.length})`});
    
    // åˆ›å»ºä»»åŠ¡åˆ—è¡¨
    const taskList = container.createEl("ul", {cls: "dataview task-list"});
    
    // ä¸ºæ¯ä¸ªä»»åŠ¡åˆ›å»ºåˆ—è¡¨é¡¹
    tasks.forEach(task => {
        const taskItem = taskList.createEl("li", {cls: "task-item"});
        
        // åˆ›å»ºå¤é€‰æ¡†
        const checkbox = taskItem.createEl("input", {
            attr: {
                type: "checkbox",
                "data-task": task.text,
                "data-path": task.path,
                "data-line": task.line
            }
        });
        
        // åˆ›å»ºä»»åŠ¡æ–‡æœ¬
        const taskText = taskItem.createEl("span", {
            text: task.text,
            cls: "task-text"
        });
        
        // åˆ›å»ºæ–‡ä»¶é“¾æ¥ - ä¿®æ”¹ä¸ºä½¿ç”¨Obsidian URIè·³è½¬åˆ°ç‰¹å®šè¡Œ
        const fileName = task.path.split("/").pop();
        // æ„å»ºObsidian URIï¼ŒåŒ…å«æ–‡ä»¶è·¯å¾„å’Œè¡Œå·
        const obsidianURI = `obsidian://open?vault=${encodeURIComponent(app.vault.getName())}&file=${encodeURIComponent(task.path)}&line=${task.line}`;
        
        taskItem.createEl("a", {
            text: ` ğŸ“„`,
            cls: "task-link",
            attr: {
                href: obsidianURI,
                title: `è·³è½¬åˆ° ${fileName} ç¬¬ ${task.line+1} è¡Œ`
            }
        });
        
        // æ·»åŠ ç‚¹å‡»äº‹ä»¶
        checkbox.addEventListener("change", async (e) => {
            if (e.target.checked) {
                // è·å–åŒ—äº¬æ—¶é—´ï¼ˆUTC+8ï¼‰
                const now = new Date();
                const beijingTime = new Date(now.toLocaleString('en-US', { timeZone: 'Asia/Shanghai' }));
                
                // æ ¼å¼åŒ–ä¸º YYYY-MM-DD HH:MM æ ¼å¼
                const year = beijingTime.getFullYear();
                const month = String(beijingTime.getMonth() + 1).padStart(2, '0');
                const day = String(beijingTime.getDate()).padStart(2, '0');
                const hours = String(beijingTime.getHours()).padStart(2, '0');
                const minutes = String(beijingTime.getMinutes()).padStart(2, '0');
                
                const timeString = `${year}-${month}-${day} ${hours}:${minutes}`;
                
                // æ„å»ºå®Œæˆæ—¶é—´æ–‡æœ¬
                const completionMark = ` âœ… ${timeString}`;
                
                // è·å–æ–‡ä»¶è·¯å¾„å’Œè¡Œå·
                const filePath = e.target.getAttribute("data-path");
                const line = parseInt(e.target.getAttribute("data-line"));
                
                // è¯»å–æ–‡ä»¶å†…å®¹
                const file = app.vault.getAbstractFileByPath(filePath);
                if (file) {
                    const content = await app.vault.read(file);
                    const lines = content.split("\n");
                    
                    // ä¿®æ”¹ä»»åŠ¡è¡Œï¼Œå°† [ ] æ›¿æ¢ä¸º [x] å¹¶æ·»åŠ å®Œæˆæ—¶é—´
                    if (line < lines.length) {
                        lines[line] = lines[line].replace(/- \[ \]/, `- [x]`) + completionMark;
                        
                        // å†™å›æ–‡ä»¶
                        await app.vault.modify(file, lines.join("\n"));
                        
                        // æ›´æ–°UI
                        taskItem.addClass("completed");
                        taskText.textContent = task.text + completionMark;
                        
                        // æ·¡å‡ºæ•ˆæœ
                        setTimeout(() => {
                            taskItem.style.opacity = "0.5";
                            taskItem.style.textDecoration = "line-through";
                        }, 300);
                    }
                }
            }
        });
    });
}

// æ·»åŠ æ ·å¼ç¾åŒ–
const style = dv.container.createEl("style");
style.textContent = `
/* æ›´å…·ä½“çš„é€‰æ‹©å™¨ï¼Œæé«˜ä¼˜å…ˆçº§ */
.custom-tasks-container h3 {
    margin-top: 20px;
    margin-bottom: 10px;
    padding-bottom: 5px;
    border-bottom: 1px solid var(--background-modifier-border);
    font-size: 0.85rem !important;  /* ä½¿ç”¨!importantç¡®ä¿ä¼˜å…ˆçº§ */
    font-weight: 600;
    display: flex;
    align-items: center;
    color: var(--text-normal);
}

.custom-tasks-container h3:before {
    content: "";
    display: inline-block;
    width: 10px;  /* å‡å°æŒ‡ç¤ºå™¨å¤§å° */
    height: 10px;  /* å‡å°æŒ‡ç¤ºå™¨å¤§å° */
    background-color: var(--interactive-accent);
    margin-right: 6px;
    border-radius: 3px;
}

.custom-tasks-container ul.dataview.task-list {
    padding-left: 0;
    margin-top: 6px;  /* å‡å°ä¸Šè¾¹è· */
}

/* å…¶ä»–æ ·å¼ä¿æŒä¸å˜ */
.custom-tasks-container .task-item {
    list-style-type: none;
    padding: 4px 6px;
    transition: all 0.3s ease;
    border-radius: 4px;
    display: flex;
    align-items: center;
    margin-bottom: 3px;
    background-color: var(--background-primary-alt);
    font-size: 0.85rem;
}
.custom-tasks-container .task-item:hover {
    background-color: var(--background-secondary);
    transform: translateX(3px);
}
.custom-tasks-container .task-text {
    margin-left: 8px;
    flex: 1;
    line-height: 1.3;  /* è°ƒæ•´è¡Œé«˜ */
}
.custom-tasks-container .task-link {
    opacity: 0.6;
    font-size: 0.9em;
    margin-left: 8px;
    cursor: pointer;
}
.custom-tasks-container .task-link:hover {
    opacity: 1;
    transform: scale(1.2);
}
.custom-tasks-container .completed {
    transition: opacity 0.5s, text-decoration 0.5s;
}
/* æ·»åŠ ç´§å‡‘å¸ƒå±€å’Œè§†è§‰å±‚æ¬¡ */
.custom-tasks-container {
    max-width: 100%;
    overflow-x: hidden;
}
.custom-tasks-container h3 {
    display: flex;
    align-items: center;
    color: var(--text-normal);
}
.custom-tasks-container h3:before {
    content: "";
    display: inline-block;
    width: 12px;
    height: 12px;
    background-color: var(--interactive-accent);
    margin-right: 8px;
    border-radius: 3px;
}
/* ä¼˜åŒ–å¤é€‰æ¡†æ ·å¼ */
.custom-tasks-container input[type="checkbox"] {
    width: 16px;
    height: 16px;
    cursor: pointer;
}
`;
```
````

### 2.4. æºä»£ç 

```
for(let i of dv.pagePaths(`"02_A"`).groupBy(p=>p.split("/")[1])){
	dv.paragraph(`### ${i.key}`);
	let a = dv.pages(`"02_A/${i.key}"`).length
	dv.paragraph(`å…±æœ‰==${a}==ç¯‡`);
	dv.list(
		dv.pages(`"02_A"`)
			.filter(p=>p.file.folder.split("/")[1]==i.key)
			.map(p=>p.file.link+' - '+moment(moment().diff(moment(Number(p.file.cday)),'days'))+'å¤©' )
	);
}
```


## 3. å¤©æ°”é¢„æŠ¥é¢æ¿

```
const weather = await fetch(`https://wttr.in/Beijing?format=%C+%t`).then(r => r.text());
dv.paragraph(`**åŒ—äº¬å¤©æ°”**: ${weather}`);
```

## 4. æœªå®Œæˆä»»åŠ¡åˆ—è¡¨

### 4.1. `0.1.0`

````
```dataviewjs
dv.taskList(dv.pages('-"templates"').file.tasks
    .where(t => !t.completed))
```
````

### 4.2. `1.0.0`

````
å•Šå•Š
````

### 4.3. `2.0.0`

````

````

## 5. ç”ŸæˆæŒ‡å®šç¬”è®°çš„ç›®å½•

````
```dataviewjs
let files = dv.pages(`"02_A/C/ç±»å‹"`)
for(let f of files) {
	let content = await app.vault.readRaw(f.file.path)
	content = content.split('\n')
	let headers = content.filter(p=>/#+ (.*?)/.test(p))
	dv.paragraph('### '+f.file.link+'\n'+headers.map(p=>p.replace(/#+/g,' '.repeat(p.match(/#+/g)[0].length*2)+'-')+'\n').reduce((a,b)=>a+b,''))
}
```
````

## 6. åœ¨æ ‡ç­¾ä¸‹æŸ¥æ‰¾ç¬”è®°å†…çš„æŸä¸ªå…³é”®è¯å¹¶åˆ—å‡ºæ‰€åœ¨è¡Œ

````
```dataviewjs
let files = dv.pages('#HAL')
extractKeywords(['ä¸²å£'],files)

async function extractKeywords(keywordArr,files) {
	let values = []
	for(let file of files) {
		let content = (await app.vault.readRaw(file.file.path)).split('\n')
		keywordArr.forEach((k)=>{
			content.filter(p=>p.includes(k))
				   ?.forEach(p=>values.push([file.file.link,p.trim()]))
		})
	}
	dv.table(["file", "æ‰€åœ¨è¡Œ"], values)
}
```
````

## 7. çƒ­é—¨èµ„æº TOP5

````
```dataviewjs
// çŸ¥è¯†å…³è”å›¾è°±
const resources = dv.pages('""')
    .sort(p => p.file.inlinks.length, 'desc');

dv.paragraph(`### çƒ­é—¨èµ„æº TOP5`);
dv.list(resources.slice(0,5).map(p => 
    `${p.file.link} (è¢«å¼•ç”¨ ${p.file.inlinks.length} æ¬¡)`
));
```
````

## 8. é¡¹ç›®è¿½è¸ª

### 8.1. `1.0.0`

- é‡‡ç”¨åˆ—è¡¨å½¢å¼

````
```dataviewjs
dv.paragraph("# é¡¹ç›®è¿½è¸ª");
const projects = dv.pages('"01_P"')
    .where(p => 
        dv.date(p.å¼€å§‹æ—¥æœŸ)?.isValid && 
        dv.date(p.æˆªæ­¢æ—¥æœŸ)?.isValid
    );

dv.list(projects.map(p => {
    // æ™ºèƒ½ä»»åŠ¡ç»Ÿè®¡ç³»ç»Ÿ
    const totalTasks = p.file.tasks.length;
    const completedTasks = p.file.tasks.filter(t => t.completed).length;
    const progress = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;

    // åŠ¨æ€æ—¶é—´è½´ç”Ÿæˆ
    const startDate = dv.date(p.å¼€å§‹æ—¥æœŸ);
    const endDate = dv.date(p.æˆªæ­¢æ—¥æœŸ);
    const timeline = `ğŸ•’ ${startDate.toFormat("MM/dd")} â†’ ${endDate.toFormat("MM/dd")}`;
    
    // ä¸‰ç»´è¿›åº¦å¯è§†åŒ–ç³»ç»Ÿ
    const progressBlocks = 'â–®'.repeat(Math.floor(progress/10));
    const remainingBlocks = 'â–¯'.repeat(10 - Math.floor(progress/10));
    const progressBar = `${progressBlocks}${remainingBlocks}`;
    
    // æ™ºèƒ½å€’è®¡æ—¶æ¨¡å—
    const today = dv.date("now");
    const daysRemaining = endDate.diff(today, "days").days;
    const statusIcon = daysRemaining < 0 ? "âŒ›" : "â³";
    const countdown = daysRemaining >= 0 
        ? `${statusIcon} å‰©ä½™${Math.floor(daysRemaining)}å¤©` 
        : `${statusIcon} è¶…æœŸ${Math.abs(Math.floor(daysRemaining))}å¤©`;

    return `${p.file.link} 
        | æ—¶é—´è½´ï¼š${timeline}
        | è¿›åº¦ï¼š${progressBar} ${progress}%
        | ${countdown}`;
}));
```
````

### 8.2. `2.0.0`

- é‡‡ç”¨è¡¨æ ¼å½¢å¼
- æ–°å¢æŒ‰å€’æ•°æ—¥æœŸæ’åºåŠŸèƒ½

````
```dataviewjs
dv.paragraph("# é¡¹ç›®è¿½è¸ª");
const projects = dv.pages('"01_P"')
    .where(p => 
        dv.date(p.å¼€å§‹æ—¥æœŸ)?.isValid && 
        dv.date(p.æˆªæ­¢æ—¥æœŸ)?.isValid
    )
    // æ–°å¢ç²¾ç¡®æ’åºé€»è¾‘[1,3](@ref)
    .sort(p => {
        const endDate = dv.date(p.æˆªæ­¢æ—¥æœŸ);
        return endDate.diff(dv.date("now"), "days").days + 1; // æŒ‰å¤©æ•°+1æ’åº
    }, "asc");

// æ„å»ºè¡¨æ ¼æ•°æ®ï¼ˆåˆ—é¡ºåºå·²è°ƒæ•´ï¼‰
const tableData = projects.map(p => {
    // å¢å¼ºçš„æ—¥æœŸè®¡ç®—[3](@ref)
    const startDate = dv.date(p.å¼€å§‹æ—¥æœŸ);
    const endDate = dv.date(p.æˆªæ­¢æ—¥æœŸ);
    const today = dv.date("now");
    
    // ç²¾ç¡®åˆ°å°æ—¶çš„æ—¶é—´å·®ï¼ˆç»“æœ+1å¤©ï¼‰
    const daysRemaining = Math.floor(endDate.diff(today, "hours").hours / 24) + 1;
    const timelineVisual = `ğŸ•’ ${startDate.toFormat("MM/dd")} â†’ ${endDate.toFormat("MM/dd")}`;

    // è°ƒæ•´åçš„åˆ—é¡ºåº
    return [
        p.file.link,
        `${daysRemaining >= 0 ? 'â³' : 'âŒ›'} ${Math.abs(daysRemaining)}å¤©${daysRemaining >= 0 ? 'å‰©ä½™' : 'è¶…æœŸâ—'}`,
        `${'â–®'.repeat(Math.floor((p.file.tasks.filter(t => t.completed).length / p.file.tasks.length || 0)*10))}${'â–¯'.repeat(10 - Math.floor((p.file.tasks.filter(t => t.completed).length / p.file.tasks.length || 0)*10))} ${Math.round((p.file.tasks.filter(t => t.completed).length / p.file.tasks.length || 0)*100)}%`,
        timelineVisual
    ];
});

// æ¸²æŸ“è¡¨æ ¼
dv.table(
    ["ç¬”è®°åç§°", "å€’æ•°æ—¥æœŸ", "è¿›åº¦", "æ—¶é—´è½´"],  // åˆ—é¡ºåºå·²äº¤æ¢
    tableData
);

```
````

### 8.3. `2.1.0`

- æ–°å¢åŠŸèƒ½ï¼š
	- åˆ©ç”¨  `<progress>æ ‡ç­¾` æ›¿ä»£å­—ç¬¦è¿›åº¦æ¡

````
```dataviewjs
dv.paragraph("# é¡¹ç›®è¿½è¸ª");
const projects = dv.pages('"01_P"')
    .where(p => 
        dv.date(p.å¼€å§‹æ—¥æœŸ)?.isValid && 
        dv.date(p.æˆªæ­¢æ—¥æœŸ)?.isValid
    )
    .sort(p => {
        const endDate = dv.date(p.æˆªæ­¢æ—¥æœŸ);
        return endDate.diff(dv.date("now"), "days").days + 1;
    }, "asc");

const tableData = projects.map(p => {
    // å¢å¼ºçš„ä»»åŠ¡ç»Ÿè®¡
    const totalTasks = p.file.tasks.length;
    const completedTasks = p.file.tasks.filter(t => t.completed).length;
    const progress = totalTasks > 0 ? 
        Math.round((completedTasks / totalTasks) * 100) : 0;

    // æ—¥æœŸè®¡ç®—å¢å¼º
    const startDate = dv.date(p.å¼€å§‹æ—¥æœŸ);
    const endDate = dv.date(p.æˆªæ­¢æ—¥æœŸ);
    const today = dv.date("now");
    const daysRemaining = Math.floor(endDate.diff(today, "hours").hours / 24) + 1;

    return [
        p.file.link,
        `${daysRemaining >= 0 ? 'â³' : 'âŒ›'} ${Math.abs(daysRemaining)}å¤©${daysRemaining >= 0 ? 'å‰©ä½™' : 'è¶…æœŸ'}`,
        // æ”¹ç”¨progressæ ‡ç­¾ â–¼
        `<progress value="${completedTasks}" max="${totalTasks || 1}" 
           title="${progress}% (${completedTasks}/${totalTasks})"
           class="task-progress"></progress>`,
        `ğŸ•’ ${startDate.toFormat("MM/dd")} â†’ ${endDate.toFormat("MM/dd")}`
    ];
});

// æ¸²æŸ“è¡¨æ ¼
dv.table(
    ["ç¬”è®°åç§°", "å€’æ•°æ—¥æœŸ", "è¿›åº¦", "æ—¶é—´è½´"],
    tableData
);

// åˆ›å»ºç‹¬ç«‹æ ·å¼ï¼ˆä¸æ”¹å˜åŸä»£ç ç»“æ„ï¼‰
const style = dv.container.createEl('style');
style.textContent = `
  .task-progress {
    width: 120px;
    height: 14px;
    accent-color: var(--interactive-accent);
  }
  .task-progress:indeterminate {
    opacity: 0.6;
  }
`;
```
````

### 8.4. `2.1.1`

- ä¿®æ”¹
	- åœ¨è¿›åº¦æ¡åå¢åŠ æ˜¾ç¤ºè¿›åº¦ç™¾åˆ†æ¯”

````
```dataviewjs
dv.paragraph("# é¡¹ç›®è¿½è¸ª");
const projects = dv.pages('"01_P"')
    .where(p => 
        dv.date(p.å¼€å§‹æ—¥æœŸ)?.isValid && 
        dv.date(p.æˆªæ­¢æ—¥æœŸ)?.isValid
    )
    .sort(p => {
        const endDate = dv.date(p.æˆªæ­¢æ—¥æœŸ);
        return endDate.diff(dv.date("now"), "days").days + 1;
    }, "asc");

const tableData = projects.map(p => {
    const totalTasks = p.file.tasks.length;
    const completedTasks = p.file.tasks.filter(t => t.completed).length;
    const progress = totalTasks > 0 ? 
        Math.round((completedTasks / totalTasks) * 100) : 0;

    const startDate = dv.date(p.å¼€å§‹æ—¥æœŸ);
    const endDate = dv.date(p.æˆªæ­¢æ—¥æœŸ);
    const today = dv.date("now");
    const daysRemaining = Math.floor(endDate.diff(today, "hours").hours / 24) + 1;

    return [
        p.file.link,
        `${daysRemaining >= 0 ? 'â³' : 'âŒ›'} ${Math.abs(daysRemaining)}å¤©${daysRemaining >= 0 ? 'å‰©ä½™' : 'è¶…æœŸ'}`,
        // å¤åˆè¿›åº¦æ˜¾ç¤º â–¼
        `<div class="progress-container">
            <progress value="${completedTasks}" max="${totalTasks || 1}" 
                title="å·²å®Œæˆ ${completedTasks}/${totalTasks}"></progress>
            <span>${progress}%</span>
        </div>`,
        `ğŸ•’ ${startDate.toFormat("MM/dd")} â†’ ${endDate.toFormat("MM/dd")}`
    ];
});

dv.table(
    ["ç¬”è®°åç§°", "å€’æ•°æ—¥æœŸ", "è¿›åº¦", "æ—¶é—´è½´"],
    tableData
);

// æ ·å¼ä¼˜åŒ–
const style = dv.container.createEl('style');
style.textContent = `
.progress-container {
    display: flex;
    align-items: center;
    gap: 8px;
    min-width: 150px;
}
progress {
    flex: 1;
    height: 14px;
    accent-color: var(--interactive-accent);
}
progress:indeterminate {
    opacity: 0.6;
}
`;
```
````

### 8.5. `2.1.2`

- ä¿®æ”¹
	- å°† â€œè¶…æœŸâ€ æˆ– â€œå‰©ä½™â€å­—æ ·æ˜¾ç¤ºè‡³XXå¤©ä¹‹å‰
	- è¿›åº¦æ¡ä¿®æ”¹ä¸ºæ¸å˜è‰²
	- æ¯ä¸€åˆ—çš„æ–‡æœ¬éƒ½è®¾ç½®ä¸ºå±…ä¸­

````
```dataviewjs
dv.paragraph("# é¡¹ç›®è¿½è¸ª");
const projects = dv.pages('"01_P"')
    .where(p => 
        dv.date(p.å¼€å§‹æ—¥æœŸ)?.isValid && 
        dv.date(p.æˆªæ­¢æ—¥æœŸ)?.isValid
    )
    .sort(p => {
        const endDate = dv.date(p.æˆªæ­¢æ—¥æœŸ);
        return endDate.diff(dv.date("now"), "days").days + 1;
    }, "asc");

const tableData = projects.map(p => {
    const totalTasks = p.file.tasks.length;
    const completedTasks = p.file.tasks.filter(t => t.completed).length;
    const progress = totalTasks > 0 ? 
        Math.round((completedTasks / totalTasks) * 100) : 0;

    const startDate = dv.date(p.å¼€å§‹æ—¥æœŸ);
    const endDate = dv.date(p.æˆªæ­¢æ—¥æœŸ);
    const today = dv.date("now");
    const daysRemaining = Math.floor(endDate.diff(today, "hours").hours / 24) + 1;

    return [
        p.file.link,
        // è°ƒæ•´çŠ¶æ€æ˜¾ç¤ºé¡ºåº â–¼
        `${daysRemaining >= 0 ? 'â³ å‰©ä½™' : 'âŒ› è¶…æœŸ'} ${Math.abs(daysRemaining)}å¤©`,
        // å›ºå®šå®½åº¦çš„è¿›åº¦æ¡ â–¼
        `<div class="progress-container">
            <progress value="${completedTasks}" max="${totalTasks || 1}" 
                title="å·²å®Œæˆ ${completedTasks}/${totalTasks}"></progress>
            <span class="percentage">${progress}%</span>
        </div>`,
        `ğŸ•’ ${startDate.toFormat("MM/dd")} â†’ ${endDate.toFormat("MM/dd")}`
    ];
});

dv.table(
    ["ç¬”è®°åç§°", "å€’æ•°æ—¥æœŸ", "è¿›åº¦", "æ—¶é—´è½´"],
    tableData
);

// å¢å¼ºç‰ˆæ ·å¼ â–¼
const style = dv.container.createEl('style');
style.textContent = `
/* è¡¨æ ¼å…¨å±€å±…ä¸­ */
.dv-table th, 
.dv-table td {
    text-align: center !important;
    vertical-align: middle !important;
}

/* è¿›åº¦æ¡å®¹å™¨ */
.progress-container {
    display: flex;
    align-items: center;
    gap: 8px;
    width: 180px;  /* å›ºå®šå®¹å™¨å®½åº¦ */
    margin: 0 auto;
}

/* è¿›åº¦æ¡å›ºå®šé•¿åº¦ */
progress {
    width: 120px !important;  /* å›ºå®šè¿›åº¦æ¡é•¿åº¦ */
    height: 14px !important;
    accent-color: var(--interactive-accent);
    -webkit-appearance: none;
    appearance: none;
}

/* ç™¾åˆ†æ¯”æ˜¾ç¤ºä¼˜åŒ– */
.percentage {
    width: 40px;
    text-align: left;
    font-family: monospace;
}

/* è¿›åº¦æ¡è‡ªå®šä¹‰æ ·å¼ */
progress::-webkit-progress-bar {
    background-color: var(--background-secondary);
    border-radius: 7px;
}
progress::-webkit-progress-value {
    background: linear-gradient(to right, #101010, #919191);
    border-radius: 7px;
}
`;
```
````

### 8.6. `2.1.3`

- ä¿®æ”¹
	- è¿›åº¦æ¡ç¾åŒ–

````
```dataviewjs
dv.paragraph("# â–²â–¼ Project Tracking");
const projects = dv.pages('"01_P"')
    .where(p => 
        dv.date(p.å¼€å§‹æ—¥æœŸ)?.isValid && 
        dv.date(p.æˆªæ­¢æ—¥æœŸ)?.isValid
    )
    .sort(p => {
        const endDate = dv.date(p.æˆªæ­¢æ—¥æœŸ);
        return endDate.diff(dv.date("now"), "days").days + 1;
    }, "asc");

const tableData = projects.map(p => {
    const totalTasks = p.file.tasks.length;
    const completedTasks = p.file.tasks.filter(t => t.completed).length;
    const progress = totalTasks > 0 ? 
        Math.round((completedTasks / totalTasks) * 100) : 0;

    const startDate = dv.date(p.å¼€å§‹æ—¥æœŸ);
    const endDate = dv.date(p.æˆªæ­¢æ—¥æœŸ);
    const today = dv.date("now");
    const daysRemaining = Math.floor(endDate.diff(today, "hours").hours / 24) + 1;

    return [
        p.file.link,
        `${daysRemaining >= 0 ? 'â³ å‰©ä½™' : 'â— è¶…æœŸ'} ${Math.abs(daysRemaining)}å¤©`,
        `<div class="progress-container">
            <progress value="${completedTasks}" max="${totalTasks || 1}" 
                title="å·²å®Œæˆ ${completedTasks}/${totalTasks}"></progress>
            <span class="percentage">${progress}%</span>
        </div>`,
        `ğŸ•’ ${startDate.toFormat("MM/dd")} â†’ ${endDate.toFormat("MM/dd")}`
    ];
});

dv.table(
    ["ç¬”è®°åç§°", "å€’æ•°æ—¥æœŸ", "è¿›åº¦", "æ—¶é—´è½´"],
    tableData
);

// å¢å¼ºç‰ˆæ ·å¼ â–¼
const style = dv.container.createEl('style');
style.textContent = `
/* è¡¨æ ¼å…¨å±€å±…ä¸­ */
table th, 
table td {
    text-align: center !important;
    vertical-align: middle !important;
}

/* è¿›åº¦æ¡å®¹å™¨ */
.progress-container {
    width: 180px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  progress {
    flex: 1;
    height: 12px;
    border-radius: 6px;
    &::-webkit-progress-bar {
      background: var(--background-modifier-border);
    }
    &::-webkit-progress-value {
      background: linear-gradient(to right, #4CAF50, #8BC34A);
      border-radius: 6px;
    }
  }
  .percentage {
    width: 40px;
    font-family: var(--font-monospace);
  }
`;
```
````

### 8.7. `3.0.0`

- é‡‡ç”¨æ›´åŠ ç°ä»£çš„å¡ç‰‡å¼å¸ƒå±€
- æ­£å¸¸é¡¹ç›®ï¼ˆå‰©ä½™å¤©æ•°â‰¥3å¤©ï¼‰ï¼šè“è‰²
- ç´§æ€¥é¡¹ç›®ï¼ˆå‰©ä½™å¤©æ•°<3å¤©ï¼‰ï¼šæ©™è‰²
- è¶…æœŸé¡¹ç›®ï¼ˆå‰©ä½™å¤©æ•°<0å¤©ï¼‰ï¼šçº¢è‰²

````
```dataviewjs
dv.paragraph("# Project");
const projects = dv.pages('"01_P"')
    .where(p => 
        dv.date(p.å¼€å§‹æ—¥æœŸ)?.isValid && 
        dv.date(p.æˆªæ­¢æ—¥æœŸ)?.isValid
    )
    .sort(p => {
        const endDate = dv.date(p.æˆªæ­¢æ—¥æœŸ);
        return endDate.diff(dv.date("now"), "days").days + 1;
    }, "asc");

// åˆ›å»ºå¡ç‰‡å®¹å™¨å‰å…ˆæ¸…é™¤å¯èƒ½çš„æµ®åŠ¨å…ƒç´ 
dv.paragraph("<div style='clear:both;'></div>");

// åˆ›å»ºå¡ç‰‡å®¹å™¨å¹¶è®¾ç½®æ˜ç¡®çš„å®½åº¦
const container = dv.el("div", "", {
  cls: "project-cards-container",
  attr: {
    style: "width:100%; display:block; clear:both;"
  }
});

// å…ˆåˆ›å»ºæ ·å¼å…ƒç´ 
const cardStyle = dv.container.createEl('style');
cardStyle.textContent = `
/* ç¡®ä¿å¡ç‰‡å®¹å™¨æ­£ç¡®æ˜¾ç¤º */
.project-cards-container {
  width: 100%;
  box-sizing: border-box;
}

/* å¡ç‰‡æ ·å¼ */
.project-card {
  background-color: var(--background-secondary);
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
  width: 100%;
}

.project-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.card-title {
  padding: 12px 16px;
  font-weight: 600;
  border-bottom: 1px solid var(--background-modifier-border);
  cursor: pointer;
  color: white;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

.title-normal {
  background: linear-gradient(135deg, #4DA6FF, #2196F3);
}
.title-urgent {
  background: linear-gradient(135deg, #FF9800, #FFC107);
}
.title-overdue {
  background: linear-gradient(135deg, #F44336, #FF5722);
}

.card-content {
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.status-badge {
  display: inline-block;
  padding: 4px 10px;
  border-radius: 12px;
  font-size: 0.85em;
  font-weight: 500;
  text-align: center;
}

.status-normal {
  background-color: rgba(76, 175, 80, 0.2);
  color: #4CAF50;
}

.status-warning {
  background-color: rgba(244, 67, 54, 0.2);
  color: #F44336;
}

.card-progress {
  display: flex;
  align-items: center;
  gap: 8px;
}

.card-progress progress {
  flex: 1;
  height: 10px;
  border-radius: 5px;
}

.card-progress progress::-webkit-progress-bar {
  background: var(--background-modifier-border);
}

.card-progress progress::-webkit-progress-value {
  background: linear-gradient(to right, #4CAF50, #8BC34A);
  border-radius: 5px;
}

.percentage {
  width: 40px;
  font-family: var(--font-monospace);
}

.card-timeline {
  font-size: 0.9em;
  color: var(--text-muted);
  text-align: center;
}
`;

// ä¸ºæ¯ä¸ªé¡¹ç›®åˆ›å»ºå¡ç‰‡
projects.forEach((p, index) => {
    const totalTasks = p.file.tasks.length;
    const completedTasks = p.file.tasks.filter(t => t.completed).length;
    const progress = totalTasks > 0 ? 
        Math.round((completedTasks / totalTasks) * 100) : 0;

    const startDate = dv.date(p.å¼€å§‹æ—¥æœŸ);
    const endDate = dv.date(p.æˆªæ­¢æ—¥æœŸ);
    const today = dv.date("now");
    const daysRemaining = Math.floor(endDate.diff(today, "hours").hours / 24) + 1;
    
    // åˆ›å»ºå¡ç‰‡åŒ…è£…å™¨ï¼Œå¼ºåˆ¶æ¯ä¸ªå¡ç‰‡å æ®å›ºå®šå®½åº¦
    const wrapper = container.createEl("div", {
      cls: "card-wrapper",
      attr: {
        style: "display:inline-block; width:calc(50% - 8px); margin-right:16px; margin-bottom:16px; vertical-align:top;"
      }
    });
    
    // å¦‚æœæ˜¯å¶æ•°ç´¢å¼•çš„å¡ç‰‡ï¼Œç§»é™¤å³è¾¹è·
    if (index % 2 === 1) {
      wrapper.style.marginRight = "0";
    }
    
    // åˆ›å»ºé¡¹ç›®å¡ç‰‡
    const card = wrapper.createEl("div", {cls: "project-card"});
    
    // å¡ç‰‡æ ‡é¢˜ - æ ¹æ®å‰©ä½™å¤©æ•°æ·»åŠ ä¸åŒçš„ç±»
    card.createEl("div", {
        cls: `card-title ${daysRemaining < 0 ? 'title-overdue' : daysRemaining < 3 ? 'title-urgent' : 'title-normal'}`,
        text: p.file.name
    }).addEventListener("click", () => {
        app.workspace.openLinkText(p.file.path, "", false);
    });
    
    // å¡ç‰‡å†…å®¹
    const cardContent = card.createEl("div", {cls: "card-content"});
    
    // çŠ¶æ€æ ‡ç­¾
    cardContent.createEl("div", {
        cls: `status-badge ${daysRemaining >= 0 ? 'status-normal' : 'status-warning'}`,
        text: `${daysRemaining >= 0 ? 'ğŸŸ¢ å‰©ä½™' : 'ğŸ”´ è¶…æœŸ'} ${Math.abs(daysRemaining)}å¤©`
    });
    
    // è¿›åº¦æ¡
    const progressContainer = cardContent.createEl("div", {cls: "card-progress"});
    progressContainer.createEl("progress", {
        attr: {
            value: completedTasks,
            max: totalTasks || 1,
            title: `å·²å®Œæˆ ${completedTasks}/${totalTasks}`
        }
    });
    progressContainer.createEl("span", {
        cls: "percentage",
        text: `${progress}%`
    });
    
    // æ—¶é—´è½´
    cardContent.createEl("div", {
        cls: "card-timeline",
        text: `ğŸ•’ ${startDate.toFormat("MM/dd")} â†’ ${endDate.toFormat("MM/dd")}`
    });
});

// åˆ é™¤è¿™é‡Œçš„ç¬¬äºŒä¸ªcardStyleå£°æ˜
// const cardStyle = dv.container.createEl('style');
// cardStyle.textContent = `...`;

// ä»¥ä¸‹æ˜¯è¡¨æ ¼è§†å›¾ä»£ç ï¼Œå¦‚æœä½ æƒ³ä¿ç•™çš„è¯
// å¦‚æœä½ åªæƒ³ä½¿ç”¨å¡ç‰‡è§†å›¾ï¼Œå¯ä»¥åˆ é™¤è¿™éƒ¨åˆ†ä»£ç 
const tableData = projects.map(p => {
    // è¡¨æ ¼æ•°æ®å¤„ç†ä»£ç ä¿æŒä¸å˜
    // ...
});

// è¡¨æ ¼æ ·å¼ - ä½¿ç”¨ä¸åŒçš„å˜é‡å
const tableStyle = dv.container.createEl('style');
tableStyle.textContent = `
/* è¿›åº¦æ¡å®¹å™¨ */
.progress-container {
    width: 180px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  progress {
    flex: 1;
    height: 12px;
    border-radius: 6px;
    &::-webkit-progress-bar {
      background: var(--background-modifier-border);
    }
    &::-webkit-progress-value {
      background: linear-gradient(to right, #4CAF50, #8BC34A);
      border-radius: 6px;
    }
  }
  .percentage {
    width: 40px;
    font-family: var(--font-monospace);
  }
`;
```
````

## 9. çŸ¥è¯†èµ„äº§æ€»è§ˆ

### 9.1. `1.0.0`

````
```dataviewjs
const totalProjects = dv.pages('"01_P"').length + dv.pages('"04_A"').length;
const archiveRate = totalProjects > 0 
    ? Math.round((dv.pages('"04_A"').length / totalProjects) * 100)
    : 0;

dv.header(2, "ğŸ“Š çŸ¥è¯†èµ„äº§æ€»è§ˆ");
dv.el("div", `
  <div class="dashboard-grid">
    <div class="dashboard-card project">
        <span class="icon">ğŸš€</span>
        <div class="value">${dv.pages('"01_P"').length}</div>
        <div class="title">æ´»è·ƒé¡¹ç›®</div>
    </div>
    <div class="dashboard-card area">
        <span class="icon">ğŸ›ï¸</span>
        <div class="value">${dv.pages('"02_A"').length}</div>
        <div class="title">æ ¸å¿ƒé¢†åŸŸ</div>
    </div>
    <div class="dashboard-card resource">
        <span class="icon">ğŸ“š</span>
        <div class="value">${dv.pages('"03_R"').length}</div>
        <div class="title">çŸ¥è¯†èµ„æº</div>
    </div>
    <div class="dashboard-card archive">
        <span class="icon">ğŸ“¦</span>
        <div class="value">${archiveRate}%</div>
        <div class="title">å½’æ¡£å®Œæˆç‡</div>
    </div>
  </div>
`);

const css = dv.container.createEl('style');
css.textContent = `
.dashboard-card {
    position: relative;
    padding: 1.5rem;
    border-radius: 16px;
    background: linear-gradient(145deg, var(--background-primary), var(--background-secondary));
    box-shadow: 0 4px 6px rgba(0,0,0,0.05);
    transition: transform 0.2s;
}
.dashboard-card:hover {
    transform: translateY(-2px);
}
.icon {
    font-size: 2em;
    opacity: 0.8;
    position: absolute;
    top: 10px;
    right: 10px;
}
`;
```
````

å½’æ¡£å®Œæˆç‡ = (å½’æ¡£é¡¹ç›®æ•°é‡ / (æ´»è·ƒé¡¹ç›®æ•°é‡ + å½’æ¡£é¡¹ç›®æ•°é‡)) Ã— 100%

ç±»ä¼¼åˆ¶é€ ä¸šçš„ã€Œè‰¯å“ç‡ã€æŒ‡æ ‡ï¼Œè¯¥æ•°å€¼é©±åŠ¨ä½ ï¼š

- å®šæœŸå›é¡¾Â `01_P`Â æ–‡ä»¶å¤¹ï¼Œå°†å·²å®Œæˆé¡¹ç›®è¿ç§»åˆ°Â `04_A`
- é˜²æ­¢é¡¹ç›®æ–‡ä»¶å¤¹æˆä¸º"æ‚ç‰©æŠ½å±‰"ï¼Œä¿æŒè¡ŒåŠ¨ç³»ç»Ÿçš„æ¸…çˆ½

### 9.2. `1.1.0`

- ä¿®æ”¹
	- å“åº”å¼å¸ƒå±€ä¼˜åŒ–

````
```dataviewjs
const totalProjects = dv.pages('"01_P"').length + dv.pages('"04_A"').length;
const archiveRate = totalProjects > 0 
    ? Math.round((dv.pages('"04_A"').length / totalProjects) * 100)
    : 0;

dv.header(2, "ğŸ“Š çŸ¥è¯†èµ„äº§æ€»è§ˆ");
dv.el("div", `
  <div class="dashboard-grid">
    <div class="dashboard-card" onclick="app.commands.executeCommandById('obsidian-explorer:reveal-in-folder:01_P')">
        <span class="icon">ğŸš€</span>
        <div class="value">${dv.pages('"01_P"').length}</div>
        <div class="title">æ´»è·ƒé¡¹ç›®</div>
    </div>
    <div class="dashboard-card" onclick="app.commands.executeCommandById('obsidian-explorer:reveal-in-folder:02_A')">
        <span class="icon">ğŸ›ï¸</span>
        <div class="value">${dv.pages('"02_A"').length}</div>
        <div class="title">æ ¸å¿ƒé¢†åŸŸ</div>
    </div>
    <div class="dashboard-card" onclick="app.commands.executeCommandById('obsidian-explorer:reveal-in-folder:03_R')">
        <span class="icon">ğŸ“š</span>
        <div class="value">${dv.pages('"03_R"').length}</div>
        <div class="title">çŸ¥è¯†èµ„æº</div>
    </div>
    <div class="dashboard-card" onclick="app.commands.executeCommandById('obsidian-explorer:reveal-in-folder:04_A')">
        <span class="icon">ğŸ“¦</span>
        <div class="value">${archiveRate}%</div>
        <div class="title">å½’æ¡£å®Œæˆç‡</div>
    </div>
  </div>
`);

const css = dv.container.createEl('style');
css.textContent = `
.dashboard-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 1rem;
    margin: 1rem 0;
}
.dashboard-card {
    cursor: pointer;
    padding: 1.2rem;
    border-radius: 12px;
    background: var(--background-secondary);
    transition: transform 0.2s, box-shadow 0.2s;
}
.dashboard-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}
`;
```
````

## 10. æ ‡ç­¾åˆ—è¡¨

````
```dataviewjs
const tagMap = new Map();
for (let page of dv.pages().where(p => p.tags)) {
    page.tags.forEach(tag => {
        if (!tagMap.has(tag)) tagMap.set(tag, new Set());
        tagMap.get(tag).add(page.file.link);
    })
}

dv.paragraph("## æ¦‚å¿µè”ç»“åº¦æ‹“æ‰‘å›¾");
for (let [tag, pages] of tagMap) {
    dv.paragraph(`**${tag}**\n${Array.from(pages)
        .slice(0,5)
        .map(p => `â–«ï¸ ${p}`).join("\n")}`);
}
```
````

## 11. å½’æ¡£çŸ¥è¯†å¤ç”¨ï¼ˆåŸºäºéšæœºæŠ½æ ·ï¼‰

````
```dataviewjs
// æ¯å¤©æ¨è3ä¸ªå½’æ¡£é¡¹ç›®
const archives = dv.pages('"04_A"')
    .sort(() => Math.random() - 0.5)
    .limit(3);

dv.paragraph("## ğŸ—ƒï¸ ä»Šæ—¥å½’æ¡£æ¨è");
dv.list(
    archives.map(p => 
        `[[${p.file.name}]] - æœ€åæ›´æ–°äº${dv.date(p.file.mtime).toFormat("yyyy/MM/dd")}
        ${p.file.tasks.filter(t => t.completed).length}/${p.file.tasks.length}ä»»åŠ¡å·²å®Œæˆ`
    )
);
```
````

é‡‡ç”¨éšæœºæŠ½æ ·ã€æ­£åˆ™åŒ¹é…ç­‰ç®—æ³•å®ç°æ™ºèƒ½åˆ†ç±»ï¼ˆç½‘é¡µ4çš„æ™ºèƒ½è§£ææ€è·¯ï¼‰

## 12. ç¬”è®°ç¼–è¾‘çƒ­åŠ›å›¾ - ç»Ÿè®¡æ¯æ—¥æ–°å¢å­—ç¬¦æ•°

````
```dataviewjs
// ç¬”è®°ç¼–è¾‘çƒ­åŠ›å›¾ - ç»Ÿè®¡æ¯æ—¥æ–°å¢å­—ç¬¦æ•°
dv.paragraph("## ğŸ“ ç¬”è®°ç¼–è¾‘çƒ­åŠ›å›¾");

// è·å–å½“å‰æ—¥æœŸå’Œè¿‡å»6ä¸ªæœˆçš„æ—¥æœŸèŒƒå›´
const today = new Date();
const sixMonthsAgo = new Date();
sixMonthsAgo.setMonth(today.getMonth() - 6);

// è·å–æ‰€æœ‰ç¬”è®°çš„ä¿®æ”¹å†å²
const allPages = dv.pages()
    .where(p => !p.file.path.startsWith("99_"))
    .array();

// åˆ›å»ºæ—¥æœŸæ˜ å°„è¡¨ (æ—¥æœŸ -> å­—ç¬¦æ•°)
const dateMap = {};

// åˆå§‹åŒ–æ—¥æœŸèŒƒå›´å†…çš„æ‰€æœ‰æ—¥æœŸ
let currentDate = new Date(sixMonthsAgo);
while (currentDate <= today) {
    const dateStr = currentDate.toISOString().split('T')[0];
    dateMap[dateStr] = 0;
    currentDate.setDate(currentDate.getDate() + 1);
}

// ç»Ÿè®¡æ¯ä¸ªæ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´å’Œå¤§å°
allPages.forEach(page => {
    const mtime = new Date(page.file.mtime);
    const dateStr = mtime.toISOString().split('T')[0];
    
    // åªç»Ÿè®¡è¿‡å»6ä¸ªæœˆå†…çš„ä¿®æ”¹
    if (mtime >= sixMonthsAgo && dateMap[dateStr] !== undefined) {
        const fileSize = page.file.size || 0;
        dateMap[dateStr] += fileSize;
    }
});

// è®¡ç®—çƒ­åŠ›å›¾é¢œè‰²çº§åˆ« - ä¿®æ”¹æ´»è·ƒåº¦åˆ¤æ–­æ ‡å‡†
const values = Object.values(dateMap).filter(v => v > 0);
const max = Math.max(...values, 1);
const avg = values.reduce((sum, val) => sum + val, 0) / values.length || 1;

// ä½¿ç”¨æ›´åˆç†çš„é˜ˆå€¼åˆ’åˆ†æ´»è·ƒåº¦
const getColorLevel = (value) => {
    if (value === 0) return 0;
    
    // ä½¿ç”¨å›ºå®šé˜ˆå€¼æˆ–åŸºäºå¹³å‡å€¼çš„ç›¸å¯¹é˜ˆå€¼
    // ä¾‹å¦‚: ä½äºå¹³å‡å€¼çš„25%ä¸º1çº§ï¼Œ25%-75%ä¸º2çº§ï¼Œ75%-150%ä¸º3çº§ï¼Œè¶…è¿‡150%ä¸º4çº§
    if (value < avg * 0.25) return 1;
    if (value < avg * 0.75) return 2;
    if (value < avg * 1.5) return 3;
    return 4;
    
    // æˆ–è€…ä½¿ç”¨å›ºå®šçš„KBé˜ˆå€¼ï¼ˆæ ¹æ®æ‚¨çš„æ•°æ®æƒ…å†µè°ƒæ•´ï¼‰
    /*
    if (value < 1024) return 1;        // å°äº1KB
    if (value < 5 * 1024) return 2;    // å°äº5KB
    if (value < 20 * 1024) return 3;   // å°äº20KB
    return 4;                          // å¤§äº20KB
    */
};

// ç”Ÿæˆçƒ­åŠ›å›¾HTML - ä½¿ç”¨GitHubé£æ ¼çš„è¡¨æ ¼å¸ƒå±€
const months = ["1æœˆ", "2æœˆ", "3æœˆ", "4æœˆ", "5æœˆ", "6æœˆ", "7æœˆ", "8æœˆ", "9æœˆ", "10æœˆ", "11æœˆ", "12æœˆ"];
const weekdays = ["å‘¨æ—¥", "å‘¨ä¸€", "å‘¨äºŒ", "å‘¨ä¸‰", "å‘¨å››", "å‘¨äº”", "å‘¨å…­"];

// åˆ›å»ºæ—¥å†ç½‘æ ¼æ•°æ® - æŒ‰å‘¨ä¸ºå•ä½
const calendarData = [];
let startDate = new Date(sixMonthsAgo);
// è°ƒæ•´åˆ°å‘¨æ—¥å¼€å§‹
startDate = new Date(startDate.getFullYear(), startDate.getMonth(), startDate.getDate() - startDate.getDay());

// ç”Ÿæˆæ—¥å†æ•°æ®
while (startDate <= today) {
    const week = [];
    
    // å¡«å……ä¸€å‘¨çš„æ•°æ®
    for (let i = 0; i < 7; i++) {
        const currentDate = new Date(startDate);
        currentDate.setDate(currentDate.getDate() + i);
        
        // ä½¿ç”¨æœ¬åœ°æ—¶åŒºæ ¼å¼åŒ–æ—¥æœŸï¼Œè€Œä¸æ˜¯UTC
        const year = currentDate.getFullYear();
        const month = (currentDate.getMonth() + 1).toString().padStart(2, '0');
        const day = currentDate.getDate().toString().padStart(2, '0');
        const dateStr = `${year}-${month}-${day}`;
        
        const value = dateMap[dateStr] || 0;
        const level = getColorLevel(value);
        
        week.push({
            date: new Date(currentDate),
            dateStr,
            value,
            level,
            month: currentDate.getMonth()
        });
    }
    
    calendarData.push(week);
    startDate.setDate(startDate.getDate() + 7); // å‰è¿›ä¸€å‘¨
}

// ç”Ÿæˆæœˆä»½æ ‡ç­¾ - ä¿®å¤æœˆä»½æ˜¾ç¤º
const monthPositions = [];
let currentMonthIndex = -1;

for (let weekIndex = 0; weekIndex < calendarData.length; weekIndex++) {
    const firstDayOfWeek = calendarData[weekIndex][0];
    const month = firstDayOfWeek.month;
    
    if (month !== currentMonthIndex) {
        currentMonthIndex = month;
        monthPositions.push({
            month: month,
            position: weekIndex
        });
    }
}

// ç”Ÿæˆçƒ­åŠ›å›¾HTML
let heatmapHtml = `
<div class="heatmap-container">
    <div class="month-labels">
`;

// ç”Ÿæˆæœˆä»½æ ‡ç­¾
for (let i = 0; i < monthPositions.length; i++) {
    const pos = monthPositions[i];
    const nextPos = i < monthPositions.length - 1 ? monthPositions[i + 1].position : calendarData.length;
    const width = (nextPos - pos.position) * 14; // 14pxæ˜¯æ¯ä¸ªå•å…ƒæ ¼çš„å®½åº¦åŠ é—´è·
    
    heatmapHtml += `<div class="month-label" style="width: ${width}px;">${months[pos.month]}</div>`;
}

heatmapHtml += `
    </div>
    <div class="calendar-grid">
        <div class="weekday-labels">
            ${weekdays.map(day => `<div class="weekday-label">${day}</div>`).join('')}
        </div>
        <div class="days-grid">
`;

// ä¿®æ”¹ä¸ºæŒ‰åˆ—ä¼˜å…ˆé¡ºåºå¡«å……
for (let week = 0; week < calendarData.length; week++) {
    for (let dayOfWeek = 0; dayOfWeek < 7; dayOfWeek++) {
        if (calendarData[week][dayOfWeek]) {
            const day = calendarData[week][dayOfWeek];
            const formattedDate = `${day.date.getFullYear()}-${(day.date.getMonth()+1).toString().padStart(2, '0')}-${day.date.getDate().toString().padStart(2, '0')}`;
            const tooltip = `${formattedDate}: ${Math.round(day.value/1024)}KB`;
            
            heatmapHtml += `<div class="day level-${day.level}" title="${tooltip}"></div>`;
        } else {
            heatmapHtml += `<div class="day level-0"></div>`;
        }
    }
}

heatmapHtml += `
        </div>
    </div>
    <div class="legend">
        <div class="legend-label">æ´»è·ƒåº¦:</div>
        <div class="legend-item level-0"></div>
        <div class="legend-item level-1"></div>
        <div class="legend-item level-2"></div>
        <div class="legend-item level-3"></div>
        <div class="legend-item level-4"></div>
        <div class="legend-label">é«˜</div>
    </div>
</div>
`;

// æ¸²æŸ“çƒ­åŠ›å›¾
dv.el("div", heatmapHtml);

// æ·»åŠ çƒ­åŠ›å›¾æ ·å¼ - ä½¿ç”¨CSS Gridå¸ƒå±€
const heatmapStyle = dv.container.createEl('style');
heatmapStyle.textContent = `
.heatmap-container {
    margin: 1rem 0;
    font-size: 12px;
    overflow-x: auto;
}
.month-labels {
    display: flex;
    margin-bottom: 4px;
    margin-left: 50px;
    color: var(--text-muted);
}
.month-label {
    text-align: center;
    font-size: 0.85em;
}
.calendar-grid {
    display: flex;
}
.weekday-labels {
    display: flex;
    flex-direction: column;
    justify-content: space-around;
    margin-right: 4px;
    color: var(--text-muted);
    font-size: 0.85em;
    width: 45px;
}
.weekday-label {
    height: 14px;
    line-height: 14px;
    text-align: right;
    padding-right: 4px;
}
.days-grid {
    display: grid;
    grid-template-columns: repeat(${calendarData.length}, 12px);
    grid-template-rows: repeat(7, 12px);
    grid-auto-flow: column;  /* ä¿®æ”¹ä¸ºæŒ‰åˆ—å¡«å……ï¼Œç¡®ä¿ä¸æ•°æ®å¡«å……é¡ºåºåŒ¹é… */
    gap: 2px;
}
.day {
    width: 12px;
    height: 12px;
    border-radius: 2px;
    transition: transform 0.1s ease-in-out;
}
.day:hover {
    transform: scale(1.2);
}
.level-0 { background-color: var(--background-modifier-border); }
.level-1 { background-color: #AED6B8; }
.level-2 { background-color: #8CC298; }
.level-3 { background-color: #5FAD79; }
.level-4 { background-color: #3C9A5F; }
.legend {
    display: flex;
    align-items: center;
    margin-top: 8px;
    justify-content: flex-end;
    color: var(--text-muted);
    font-size: 0.85em;
}
.legend-item {
    width: 10px;
    height: 10px;
    margin: 0 2px;
    border-radius: 2px;
}
.legend-label {
    margin: 0 4px;
}
`;
```
````