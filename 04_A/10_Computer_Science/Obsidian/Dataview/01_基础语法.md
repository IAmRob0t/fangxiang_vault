---
tags:
  - Obsidian
---
>  [PKMer_Obsidian 插件：Dataview](https://pkmer.cn/Pkmer-Docs/10-obsidian/obsidian%E7%A4%BE%E5%8C%BA%E6%8F%92%E4%BB%B6/dataview/dataview/)

# Metadata 元数据

或许你在其他地方也听过 Metadata 这个概念，它的适用范围远远不止于 Dataview 这个插件。

> [!quote] Wiki
> 元数据（Metadata，台湾又常译作诠释资料、元数据、中介数据、中继数据），是一群数据，其内容提供了有关于另一群数据的信息[1]。英文前缀词meta-的意思是之后，进而有超出界限（transcending）之意思，其语义来自形而上学的外语构词meta-physics （希腊语：μετά-φυσικά） ，具有探求现象或对象背后之本质的意味。

一个元属性包含两个部分：Key 和 Value（其实就是一个键值对），假如 Key 是 name，对应的 Value 就是具体的名字。假如 key 是 age，对于的 value 就是具体的年龄。

> [!warning] 请注意，在后文中，我们还会
> 把 Key 称为 “属性名 Field Name”
> 把 Value 称为 “属性域 Field”；

## 1. Dataview 中的 Metadata

元数据是关于数据的结构化的数据，它包含了文件的许多信息。这种一一对应的信息，仿佛天然就是为了作为一种索引，用以辅助查询。

对于 Dataview 来说，**它无法直接查询文档中的内容，只能查询有索引的内容**。文件中只有元数据和隐式字段是具有索引的，简单的介绍一下元数据与隐式字段：

 **文件中的元数据**：在文件中，有两种东西可以有元数据，分别是**文件本身**和**文件中的列表**。其中文件本身的元数据分别来自文件的文档属性和文中的内联字段，文件中列表的元数据一般放在该列表的末尾（列表包括无序列表、有序列表和任务）。这些元数据与这篇文件绑定，可以被 Dataview 检索作为分类的依据或者作为展示的内容。
 
**文件的隐式字段**：文件中还有一些已经自动有索引的内容，比如文件的名字，文件的创建时间、修改时间等，我们称之为文件的隐式字段。他们也是能够被 Dataview 检索到的。

## 2. Metadata 的数据类型

Metadata 是一个键值对（Key - Value，在这里称 Field Name - Field）

### 2.1. Field Name 属性名

我们为文件添加元数据后，不一定会采用我们给定的格式，它会在**内部**（不会显示）自动对 Field Name 值进行一定修改，以保证格式统一。

> [!NOTE] Field Name 值自动修改规则
> 如果有粗体、斜体等格式，格式会被擦除，变成普通文本；
> 如果中间无空格，原本有大写的 Key 值和全部字母小写后的值都可以当作其 Key 值；
> 如果中间有空格，会被替换成 `-`，并且所有大写字母会被换成小写字母；

举几个例子

| 原 Field Name 的写法 |                修改后                 |       改动内容        |
| :--------------: | :--------------------------------: | :---------------: |
|   `**basic**`    |              `basic`               |       去掉粗体        |
|     `Basic`      | `Basic` 或 `basic` （不能是 `BaSic` 之类） |       增加了小写       |
|  `basic field`   |           `basic-field`            |    用 `-` 替换空格     |
| `**Bold Field**` |             `bold-key`             | 去掉粗体，并替换空格，同时全部小写 |

### 2.2. Field 属性域

#### 2.2.1. string 字符串

默认的数据类型，也是最常用的数据类型。当一个 Field 没有对应的类型时，就为 string 类型（因此可以用双引号包含，也可以不用），常见的可以是，一个单词，一段话等。

#### 2.2.2. number 数字类型

不区分整数还是小数，全部都为数字类型。

#### 2.2.3. boolean 布尔类型

分为 true 和 false 两种，代表真和假；

文件默认的元数据 `file.starred` 的数据类型也是布尔类型，代表是否标星号。但是星标插件已经被 [书签](https://pkmer.cn/Pkmer-Docs/10-obsidian/obsidian%E6%A0%B8%E5%BF%83%E6%8F%92%E4%BB%B6/%E4%B9%A6%E7%AD%BE) 插件取代，也许后面这个属性 `file.starred` 会改名；

#### 2.2.4. date 时间类型

匹配 [ISO8601表示法](https://pkmer.cn/Pkmer-Docs/10-obsidian/obsidian%E7%A4%BE%E5%8C%BA%E6%8F%92%E4%BB%B6/dataview/dataview%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95/42---iso-8601) 的文本将自动转换为日期对象；

例如：`2023-07-17`，`2023-07-17T16:34:000`，`2021-08-13T14:20:18.992847200-04:00`，能够包含年月日、时分秒、纳秒甚至时区的信息；

- 从时间域 field 中提取信息

|        语法         |            解释             |
| :---------------: | :-----------------------: |
|    `field.year`     |           获取年份            |
|    `field.month`    |           获取月份            |
|  `field.weekyear`   | 获取周数（从每年的第一天开始算，一年约 52 周） |
|    `field.week`     |   获取周数（从每个月第一天，一月约 4 周）   |
|   `field.weekday`   | 获取星期数（星期 1 为 1、星期 2 为 2）  |
|     `field.day`     |           获取天数            |
|    `field.hour`     |           获取小时数           |
|   `field.minute`    |           获取分钟数           |
|   `field.second`    |           获取秒数            |
| `field.millisecond` |           获取纳秒数           |

#### 2.2.5. duration 定长时间

Date 时间是指一个时间点，而 Duration 是指一段时间。比如 1 分钟、1 天、1 年等；

- 语法：
	- 时间长度 + 单位
	- 中间可以紧挨着，也可以空格、逗号分割，还可以组合；
	- 时间长度是数字，单位单复数都行，有：
	    - 秒：s、sec、secs、second、seconds；
	    - 分钟：m、min、mins、minnute、minutes；
	    - 小时：h、hr、hrs、hour、hours；
	    - 天：d、day、days；
	    - 周：w、wk、wks、week、weeks；
	    - 月：mo、month、months；（注意和分钟区分）
	    - 年：yr、yrs、year、years；（注意没有 y）

> [!example] 例子
> - 紧挨着：1min
> - 空格分割：3 day
> - 逗号分隔：2 min, 3 hours
> - 组合：1 second 2 min 3 h
> - 顺序无关紧要：2m1s3h 和上一个的结果一致

#### 2.2.6. link 链接

链接也是其中的一种数据类型，语法和在正文中的一致： `[[链接]]` 或 `[[链接|显示的名字]]` ；

示例：

- 在文档属性：`Linkto: [[...]]`
- 在行内字段中：`Linkto:: ...` ；

#### 2.2.7. array 数组（List 列表）

添加在文档属性中有两种写法：

- 如果是源码模式，有两种写法：
    - 第一种是以逗号分割，用方括号 `[ ]` 括起来；
    - 第二种是用无序列表；

```
---
tags: [obsidian, 插件, Dataview]
---
```

也可以写成

```
---
tags: 
  - obsidian
  - 插件
  - Dataview
---
```

- 如果你是实时预览模式，你只需要在选择该属性为列表 List，每输入一个值点击回车确认即可

![Dataview 中的 Metadata 的数据类型--array 数组（List 列表）](https://cdn.pkmer.cn/images/PixPin_2023-12-17_14-28-03.gif!pkmer)

添加在行内字段中就直接用逗号分割，如 tags:: obsidian, 插件, Dataview

> [!warning] 注意
> 一个列表中的所有属性的属性值都要相同，因此例如 example:: 值1, 值2, 3。这三个属性值的数据类型都是字符串，包括第三个属性值 “3”。
> 如果所有属性值都是数字，或者都是布尔值的时候，他们的数据类型才会是数字或者字符串。但凡有一个不是，dataview 会把他们都以字符串的格式识别。因此如果遇到你用列表中的数字加减发现报错，不妨用 typeof() 函数检查一下这个 ” 数字 ” 会不会其实是字符串。

#### 2.2.8. object 对象

有的属性，没法用一个值来概括，而需要多个值来概括时，这个属性就是一个对象，我们把对象的一个个属性都作为属性域。（列表的多值属性是同一种含义，共享一个属性，对象的多个属性域有不同的含义，是属性的属性，如果有学过面向对象编程应该很熟悉）

语法：

```
--- 
obj: 
  key1: "Value" 
  key2: 3 
  key3: 
   - "List1" 
   - "List2" 
   - "List3" 
---
```

举个例子，比如文件为记录一部电影，属性可以有前奏和片尾曲这两个对象，他们可以有歌名和歌手的属性：

```
Prelude: 
  - name: ...
  - singer: ...
EndSong:
  - name: ...
  - singer: ...
```

> [!warning] 这种写法只能在 Frontmatter 中使用，Inline Field 中无法使用；

从这里也能看出元数据对于查询有很大帮助。我们可以利用不同数据类型的元数据提供的信息，对文件进行检索，最终查询出符合我们给定的条件

## 3. 添加 Metadata 至文件

有两种方式为一个 markdown 文件添加元数据

- 添加到 Properties 文档属性部分；
- 添加到 Inline Fields 行内字段中；

### 3.1. Properties 文档属性

> [!quote]
> Properties help you organize information about a note. Adding properties to a note helps you track structured data such as text, links, dates and numbers. Properties can also be used in combination with Community plugins that can do useful things with your structured data.
> 文档属性可帮助你组织有关笔记的信息。将属性添加到笔记中可以帮助你跟踪结构化数据，如文本、链接、日期和数字。属性还可以与社区插件结合使用，这些插件可以对结构化数据做有用的事情。

obsidian 1.4 版本以前，你只能手动在笔记最开头输入 `---` 来添加文档属性，现在官方对这块区域做了优化，添加了几种更加方便的方式，并且加入了渲染来降低使用门槛，避免了手动输入时产生的各种语法错误。

- 快捷键法：`ctrl + ;`
- 命令面板法：`ctrl + p`，搜索添加文档属性 (英文为 add file property)；
- 鼠标右键文件标题：选择增加文档属性 (英文为 add file property)；
- 标签页标题栏的竖着的三个点：选择增加文档属性 (英文为 add file property)；
- 原来的手动输入 `---` 依旧可行；

> [!NOTE] YAML 语法规则
> - 大小写敏感，可以使用中文；
> - 冒号后要跟一个空格；
> - 使用缩进来代表层级关系；
> - 缩进时只能用空格，不能用 Tab；
> - 缩进的空格数不重要，但是同一级元素必须左对齐；
> - 用井号标识注释，从 `#` 到当前行的末尾是注释；

### 3.2. Inline Fields 行内字段

如果数据是对于整个文件的，在文档属性中加入元数据，自然很直观。但是如果这个元数据专门针对该文件中的某一个区域中，dataview 提供了更加合理的方法——使用内联字段插入元数据到文件中的某个区域。

内联字段插入元数据的语法很简单，就是 `Key::Value`

插入内联字段分为两类

- **行内字段单独成行**

```
Key::Value
```

注意前面不能有其他内容，否则会被当成 Key 中的内容。`::` 之后的所有内容都是 Value 的值.

![Dataview：向文件添加合适的元数据--Inline Fields 行内字段](https://cdn.pkmer.cn/images/20231217140122.png!pkmer)

- **行内字段插入某一行**

```
读完这本的感受：[feel:: ...]；
读完这本的感受：(feelisthewordafter:: ...)；
```

用方括号或者圆括号把 `Key::Value` 括起来，区别在于用圆括号括起来后，在阅读模式下不会显示 Key。

![Dataview：向文件添加合适的元数据--Inline Fields 行内字段](https://cdn.pkmer.cn/images/20231217140701.png!pkmer)

![Dataview：向文件添加合适的元数据--Inline Fields 行内字段](https://cdn.pkmer.cn/images/20231217140730.png!pkmer)


## 4. 添加 Metadata 至列表和任务

![Dataview：向列表和任务添加元数据--](https://cdn.pkmer.cn/images/20231217141056.png!pkmer)

两种方法记录的实际上是同一个元数据。也就是说，表情 🗓️ 对应的属性就是 due，即截止日期。用图像代表截止日期更直观。

> [!tip] 提示
> 对于 obsidian 来说，任务和列表（有序列表和无序列表）实际上是同一类数据的不同形式，都可以用这种方法为他们加上元数据来方便后续的查询；

除此之外，还有其他的 Emoji 表情代表不同的含义：

| Emoji 表情 | 属性 Field Name |   含义   |
| :------: | :-----------: | :----: |
|   🗓️    |      due      |  截止日期  |
|    ✅     |  completion   |  完成日期  |
|    ➕     |    created    |  创建日期  |
|    🛫    |     start     |  开始日期  |
|    ⏳     |   scheduled   | 预期完成日期 |

obsidian 最新版本已经不支持 win7 了，而 win10 及以上版本的电脑，可以只通过一个快捷键加一次鼠标点击，就能输入这些表情；

在任意界面，用快捷键 `win + .` 或 `win + ;` 打开 Emoji 表情窗口，上面五个 Emoji 标签均能在里面找到，分别为：

- 🗓：线圈日历，在 “庆祝和物品” 中；
- 🛫：航班起飞：在 “交通和地点” 栏中第六行，直接打字 “飞机” 也会出现；
- ✅：空心对勾，在最后一栏 “符号” 中；
- ➕：加号：在最后一栏 “符号” 中，直接打字 “加号” 也会出现；
- ⏳：沙正往下流的沙漏，在 “庆祝和物品” 的最后一行，直接打字 “沙漏” 也会出现；

还有其他几种可能更适合你的添加图标的方式

- [Obsidian 插件：Icon Shortcodes 通过短代码方式，快速筛选和输入](https://pkmer.cn/Pkmer-Docs/10-obsidian/obsidian%E7%A4%BE%E5%8C%BA%E6%8F%92%E4%BB%B6/obsidian-icon-shortcodes)
- [Obsidian 插件：Emoji Toolbar 快速插入 Emoji 符号](https://pkmer.cn/Pkmer-Docs/10-obsidian/obsidian%E7%A4%BE%E5%8C%BA%E6%8F%92%E4%BB%B6/obsidian-emoji-toolbar)
- [Obsidian 插件：Obsidian Icons 提供插入图标符号的功能](https://pkmer.cn/Pkmer-Docs/10-obsidian/obsidian%E7%A4%BE%E5%8C%BA%E6%8F%92%E4%BB%B6/obsidian-icons-plugin)

# 隐式字段

