---
tags:
  - ç¡¬ä»¶
---
-  [[0.96OLED-IIC-åŸç†å›¾.pdf]]
-  [[SSD1306-Revision 1.1 (Charge Pump).pdf]]

# ç‰¹ç‚¹

- 128Ã—64 ç‚¹çŸ©é˜µé¢æ¿ï¼›
- æœ‰ 256 é˜¶å¯¹æ¯”åº¦å¯è°ƒèŠ‚ï¼›
- æ”¯æŒ 6800/8080 å¹¶è¡Œæ€»çº¿ï¼›
- æ”¯æŒ SPIã€I2C ä¸²è¡Œæ€»çº¿ï¼›
- æ”¯æŒæ°´å¹³æ–¹å‘å’Œå‚ç›´æ–¹å‘çš„æ»šåŠ¨ï¼›
- æ”¯æŒè¡Œæˆ–åˆ—çš„é‡æ˜ å°„ï¼›

# è®¾å¤‡åœ°å€

![[SSD1306-Revision 1.1 (Charge Pump).pdf#page=19&rect=66,553,532,682&color=note|ğŸ“–]]

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è®¾å¤‡åœ°å€ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š
- ç¬¬ 0 ä½ -> è¯»å†™ä½ -> **â€˜1â€™è¡¨ç¤ºè¯»ï¼›â€˜0â€™è¡¨ç¤ºå†™**
- ç¬¬ 1 ä½ -> ä»æœºåœ°å€ä½ -> **â€˜DC#å¼•è„šå†³å®šæ˜¯0è¿˜æ˜¯1 â€™**
	- ![[0.96OLED-IIC-åŸç†å›¾.pdf#page=1&rect=186,406,401,539|0.96OLED-IIC-åŸç†å›¾, p.1]]
- ç¬¬ 2~7 ä½ -> å›ºå®šå€¼0b011110;

å› æ­¤
- 0b0111 1000 -> 0x78 -> å†™æ•°æ®æ—¶çš„è®¾å¤‡åœ°å€
- 0b0111 1001 -> 0x79 -> è¯»æ•°æ®æ—¶çš„è®¾å¤‡åœ°å€

```c
// ç¬¬ä¸€ç§ï¼Œåˆ†åˆ«å®šä¹‰è¯»å†™è®¾å¤‡åœ°å€
#define OLED_WRITE_ADDR			0x78
#define OLED_READ_ADDR			0x79

// ç¬¬äºŒç§ï¼Œå®šä¹‰åŸºç¡€åœ°å€ï¼Œé€šè¿‡æ”¹å˜è¯»å†™ä½æ¥æ”¹å˜åœ°å€
#define OLED_ADDR				0x78
#define OLED_WRITE				0x00
#define OLED_READ				0x01
```
# SSD1306 çš„ I2C æ€»çº¿æ•°æ®æ ¼å¼

![[SSD1306-Revision 1.1 (Charge Pump).pdf#page=20&rect=73,422,523,713&color=note|ğŸ“–]]

![[SSD1306-Revision 1.1 (Charge Pump).pdf#page=20&rect=69,132,541,246&color=note|ğŸ“–]]

- æ§åˆ¶å­—èŠ‚
	1. ç”¨äºè¡¨æ˜ç´§è·Ÿç€çš„ä¸‹ä¸€ä¸ªå­—èŠ‚æ•°æ®æ˜¯å‘½ä»¤æ•°æ®è¿˜æ˜¯å†™å…¥GRAMçš„æ•°æ®
	2. Co ä½è¡¨ç¤ºç´§è·Ÿç€çš„æ•°æ®æ˜¯ä¼šä»…æœ‰æ•°æ®å­—èŠ‚è¿˜æ˜¯ä¼šåŒ…å«æ§åˆ¶å­—èŠ‚ï¼Œé»˜è®¤ä¸º 0
	3. DC#ä½ä¸º1è¡¨ç¤ºç´§è·Ÿç€çš„å­—èŠ‚æ•°æ®ä¸ºå†™å…¥GRAMçš„æ•° ï¼Œä¸º 0 åˆ™è¡¨ç¤ºæ˜¯ä¸€ä¸ªå‘½ä»¤æ•°æ®ï¼Œè¿™ä¸€ä½å’Œç¡¬ä»¶çš„DC#å¼•è„šæ— å…³

```c
/*
è®¾å¤‡åœ°å€ -> æ§åˆ¶å­—èŠ‚ -> æ•°æ®å­—èŠ‚1 -> ... -> æ•°æ®å­—èŠ‚n
0x78	-> 0x00		->cmd
*/

void OLED_WriteCmd(uint8_t cmd)
{
	I2C_Start();
	I2C_WriteByte(OLED_WRITE_ADDR);
	// I2C_WriteByte(OLED_ADDR | OLED_WRITE);
	I2C_WriteByte(0x00);
	I2C_WriteByte(cmd);
	I2C_Stop();
}
```

```c
/*
è®¾å¤‡åœ°å€ -> æ§åˆ¶å­—èŠ‚ -> æ•°æ®å­—èŠ‚1 -> ... -> æ•°æ®å­—èŠ‚n
0x78	-> 0x40		-> data
*/
void OLED_WriteData(uint8_t data)
{
	I2C_Start();
	I2C_WriteByte(OLED_WRITE_ADDR);
	// I2C_WriteByte(OLED_ADDR | OLED_WRITE);
	I2C_WriteByte(0x40);
	I2C_WriteByte(data);
	I2C_Stop();
}
```

```c
/*
è®¾å¤‡åœ°å€ -> æ§åˆ¶å­—èŠ‚ -> æ•°æ®å­—èŠ‚1 -> ... -> æ•°æ®å­—èŠ‚n
0x78	-> 0x40		-> data		-> ... -> data_n
*/
void OLED_WriteNBytes(uint8_t *buf, uint16_t length)
{
	uint16_t i = 0;
	if(buf == NULL) return;
	I2C_Start();
	I2C_WriteByte(OLED_WRITE_ADDR);
	I2C_WriteByte(0x40);
	for(i = 0; i < length; i ++)
	{
		I2C_WriteByte(buf[i]);
	}
	I2C_Stop();
}
```

> [!question] é€šè¿‡I2Cæ€»çº¿å‘é€è¿‡å»çš„æ•°æ®æ˜¯å¦‚ä½•æ˜¾ç¤ºåˆ°å±å¹•ä¸Šçš„ï¼Ÿ
> - ![[SSD1306-Revision 1.1 (Charge Pump).pdf#page=7&rect=54,177,544,694&color=note|ğŸ“–]]
> - é€šè¿‡å¤–éƒ¨å¤„ç†å™¨ -> å†…éƒ¨ MCU æ¥å£ -> GDDRAM å†…éƒ¨æ˜¾å­˜ -> æ˜¾ç¤ºæ§åˆ¶å™¨ -> è¡Œ / åˆ—åœ°å€é©±åŠ¨ -> 128 \* 64 æ˜¾ç¤ºçŸ©é˜µ
> - æ ¸å¿ƒå°±æ˜¯ GDDRAM

# é‡è¦æ§åˆ¶å‘½ä»¤

> [!question] å½“I2Cå‘é€å¤šä¸ªå­—èŠ‚æ•°æ®çš„æ—¶å€™ï¼Œæ˜¾å­˜æ˜¯å¦‚ä½•ä¿å­˜è¿™äº›æ•°æ®çš„ï¼Ÿ
> ä½¿ç”¨åœ°å€æ¨¡å¼

- åœ°å€æ¨¡å¼
	- é¡µåœ°å€æ¨¡å¼ï¼ˆPageï¼‰
	- æ°´å¹³åœ°å€æ¨¡å¼ï¼ˆHorizontalï¼‰
	- å‚ç›´åœ°å€æ¨¡å¼ï¼ˆVerticalï¼‰
- ä½œç”¨ï¼šå†³å®šI2Cå‘é€å¤šä¸ªå­—èŠ‚æ•°æ®åˆ°æ˜¾å­˜ï¼Œæ˜¾å­˜ä¿å­˜è¿™äº›æ•°æ®æ—¶ï¼Œåœ°å€çš„å˜åŒ–æ–¹å¼ã€‚

## é¡µåœ°å€æ¨¡å¼

![[SSD1306-Revision 1.1 (Charge Pump).pdf#page=34&rect=146,323,440,422&color=note|ğŸ“–]]

( [[SSD1306-Revision 1.1 (Charge Pump).pdf#page=34&selection=40,0,41,20&color=note|ğŸ“–]])
In page addressing mode, after the display RAM is read/written, the column address pointer is increased automatically by 1. 
åœ¨é¡µåœ°å€æ¨¡å¼ä¸‹ï¼Œå½“å¾€æ˜¾å­˜é‡Œé¢å†™å…¥æ•°æ®åï¼Œåˆ—åœ°å€æŒ‡é’ˆä¼šè‡ªåŠ¨é€’å¢1

- è®¾ç½®å¥½èµ·å§‹é¡µå’Œèµ·å§‹åˆ—ä¹‹åï¼Œå°±å¯ä»¥è¿ç»­å‘é€æ•°æ®ï¼Œè€Œä¸ç”¨æ¯å‘é€ä¸€ä¸ªæ•°æ®å°±å»æŒ‡å®šä¸€ä¸ªé¡µå’Œåˆ—çš„åœ°å€äº†
- å¦‚æœåˆ—åœ°å€æŒ‡é’ˆé€’å¢åˆ°äº†è®¾ç½®çš„ç»“æŸåˆ—åœ°å€ï¼Œé‚£ä¹ˆåˆ—åœ°å€æŒ‡é’ˆå°±ä¼šå¤ä½å›åˆ°è®¾ç½®çš„èµ·å§‹åˆ—åœ°å€ï¼Œè€Œé¡µåœ°å€æŒ‡é’ˆæ˜¯ä¸ä¼šæœ‰å˜åŒ–çš„ã€‚ä¸ºäº†è®¿é—®ä¸‹ä¸€é¡µæ˜¾å­˜ä¸­çš„å†…å®¹ï¼Œç”¨æˆ·å¿…é¡»è®¾ç½®æ–°çš„é¡µå’Œåˆ—çš„èµ·å§‹åœ°å€ã€‚

## è®¾ç½®åƒç´ æ˜¾ç¤ºåœ°å€

å®šä¹‰è®¿é—®æ˜¾å­˜æ•°æ®çš„èµ·å§‹æŒ‡é’ˆéœ€è¦ä»¥ä¸‹å‡ æ­¥ï¼š
1. é€šè¿‡å‘é€å‘½ä»¤0xB0~0xB7è®¾ç½®å›¾åƒæ˜¾ç¤ºä½ç½®çš„èµ·å§‹é¡µåœ°å€
2. é€šè¿‡å‘é€å‘½ä»¤0x00~0x0Fè®¾ç½®å›¾åƒæ˜¾ç¤ºä½ç½®çš„èµ·å§‹åˆ—åœ°å€çš„ä½å››ä½
3. é€šè¿‡å‘é€å‘½ä»¤0x10~0x1Fè®¾ç½®å›¾åƒæ˜¾ç¤ºä½ç½®çš„èµ·å§‹åˆ—åœ°å€çš„é«˜å››ä½

```c
void OLED_SetPageAddr_PAGE(uint8_t addr)
{
	if(mem_mode != PAGE_ADDR_MODE)	return;
	if(addr > 7)	return;
	OLED_WriteCmd(0xB0 + addr);
}

void OLED_SetColAddr_PAGE(uint8_t addr)
{
	if(mem_mode != PAGE_ADDR_MODE)	return;
	if(addr > 0x7F)		return;
	OLED_WriteCmd(0x00 + (addr & 0x0F));
	OLED_WriteCmd(0x10 + (addr>>4));
}
```

## é¡µåœ°å€æ¨¡å¼ä¸‹åƒç´ çš„æ˜¾ç¤ºæµç¨‹

- æ¯”å¦‚åœ¨ç¬¬5é¡µçš„ç¬¬56åˆ—å¼€å§‹æ˜¾ç¤ºä¸‰ä¸ªç‚¹
	- è®¾ç½®é¡µ/åˆ—åœ°å€ - `OLED_SetPosition(5,56);`
	- I2Cå¾€GRAMé‡Œé¢å†™å¤šä¸ªæ•°æ®æ¥æ˜¾ç¤ºåƒç´ 
		- `OLED_WriteData(0x01);`
		- `OLED_WriteData(0x01);`
		- `OLED_WriteData(0x01);`

# å…¶ä»–å‘½ä»¤

![[SSD1306-Revision 1.1 (Charge Pump).pdf#page=28&rect=45,455,565,695|SSD1306-Revision 1.1 (Charge Pump), p.28]]

```c
/* 1. åŸºç¡€å‘½ä»¤åŠŸèƒ½å‡½æ•° */
extern void OLED_SetContrastValue(uint8_t value);
#define ENTIRE_DISP_ON()		OLED_WriteCmd(0xA5)
#define ENTIRE_DISP_OFF()		OLED_WriteCmd(0xA4)
#define DISP_NORMAL()			OLED_WriteCmd(0xA6)
#define DISP_INVERSE()			OLED_WriteCmd(0xA7)
#define DISP_ON()				OLED_WriteCmd(0xAF)
#define DISP_OFF()				OLED_WriteCmd(0xAE)
```

![[SSD1306-Revision 1.1 (Charge Pump).pdf#page=28&rect=33,269,575,388|SSD1306-Revision 1.1 (Charge Pump), p.28]]

```c
/* 2. æ»šåŠ¨å‘½ä»¤åŠŸèƒ½å‡½æ•° */
typedef enum
{
	H_RIGHT		= 0,
	H_LEFT		= 1,
}H_SCROLL_DIR
extern void OLED_H_Scroll(H_SCROLL_DIR dir, uint8_t start, uint8_t fr_time, uint8_t end);
```

![[SSD1306-Revision 1.1 (Charge Pump).pdf#page=31&rect=22,319,560,519|SSD1306-Revision 1.1 (Charge Pump), p.31]]

```c
/* 4. ç¡¬ä»¶é…ç½®åŠŸèƒ½å‡½æ•° */
extern void OLED_SetDispStartLine(uint8_t line);

#define OLED_SEG_REMAP()		OLED_WriteCmd(0xA1)
#define OLED_SEG_NOREMAP()		OLED_WriteCmd(0xA0)

extern void OLED_SetMuxRatio(uint8_t ratio);

#define OLED_SCAN_NORMAL()		OLED_WriteCmd(0xC0)
#define OLED_SCAN_REMAP()		OLED_WriteCmd(0xC8)

extern void OLED_SetDispOffset(uint8_t offset);
```

![[SSD1306-Revision 1.1 (Charge Pump).pdf#page=32&rect=25,597,556,759|SSD1306-Revision 1.1 (Charge Pump), p.32]]

```c
/* 5. æ—¶é—´è®¾ç½®åŠŸèƒ½å‡½æ•° */
extern void OLED_SetDCLK_Freq(uint8_t div, uint8_t freq);
extern void OLED_SetPreChargePeriod(uint8_t phasel, uint8_t phase2);
```

# åˆå§‹åŒ–æµç¨‹

![[SSD1306-Revision 1.1 (Charge Pump).pdf#page=64&rect=71,93,522,690|SSD1306-Revision 1.1 (Charge Pump), p.64]]

1. è®¾ç½®å¤šé‡å¤ç”¨ç‡å€¼ä¸º 0x3F
2. è®¾ç½®æ˜¾ç¤ºåç§»å€¼ä¸º 0
3. è®¾ç½®æ˜¾ç¤ºèµ·å§‹è¡Œä¸º 0
4. è®¾ç½®åˆ—é‡æ˜ å°„
5. è®¾ç½® COM æ‰«ææ–¹å‘
6. è®¾ç½® COM ç¡¬ä»¶é…ç½®
7. è®¾ç½®å¯¹æ¯”åº¦
8. è®¾ç½®å…¨å±æ˜¾ç¤ºè¾“å‡º
9. è®¾ç½®æ˜¾ç¤ºæ¨¡å¼ä¸ºæ­£å¸¸æ˜¾ç¤º
10. è®¾ç½®æ™¶æŒ¯é¢‘ç‡å€¼
11. ä½¿èƒ½ç”µè·ç¢°æ’
12. å¼€å¯æ˜¾ç¤º

```c
/* 7.  */
void OLED_Init(void)
{
	OLED_SetMemAddeMode(PAGE_ADDR_MODE);		// 0. è®¾ç½®åœ°å€æ¨¡å¼
	OLED_SetMuxRatio(0x3F);						// 1. è®¾ç½®å¤šè·¯å¤ç”¨ç‡
	OLED_SetDispOffset(0x00);					// 2. è®¾ç½®æ˜¾ç¤ºçš„åç§»å€¼
	OLED_SetDispStartLine(0x00);				// 3. è®¾ç½®èµ·å§‹è¡Œ
	OLED_SEG_REMAP();							// 4. è¡Œç¿»è½¬
	OLED_SCAN_REMAO();							// 5. æ­£å¸¸æ‰«æ
	OLED_SetComConfig(0x00, 0x00);				// 6. COM å¼•è„šè®¾ç½®
	OLED_SetContrastValue(0x7F);				// 7. è®¾ç½®å¯¹æ¯”åº¦
	ENTIRE_DISP_OFF();							// 8. å…¨å±ç‚¹äº®/ç†„ç­
	DISP_NORMAL();								// 9. æ˜¾ç¤ºæ¨¡å¼
	OLED_SetDCLK_Freq(0x00, 0x08);				// 10. è®¾ç½®åˆ†é¢‘ç³»æ•°å’Œé¢‘ç‡å¢å€¼
	OLED_SetChargePump(PUMP_ENABLE);			// 11. ä½¿èƒ½ç”µè·ç¢°æ’
	
	OLED_SetComConfig(COM_PIN_ALT, COM_NOREMAP);
	
	DISP_ON();
}
```

# 