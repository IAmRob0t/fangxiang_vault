---
title: 嵌入式 C 语言函数的返回值，也有其应用“潜规则”？
source: https://mp.weixin.qq.com/s/0Y6GDoyPKf4FHLTk_SIM6g
author:
  - "[[微信公众平台]]"
published: 
created: 2025-04-02
description: 
tags:
  - clippings
  - c
---

嵌入式软件代码里面会有非常多的逻辑功能函数，通常这些函数都带有形参和返回值，灵活运用返回值可以让软件工程师知道函数具体的执行结果，便于开发过程分析。

# **C语言函数的返回值**

C语言函数可以通过返回值表示输出结果，例如 log() 函数的返回值会根据不同的输入，返回不同的值。

再比如，我们定义一个函数 myopen()，用于打开某个文件，那么，这个函数要么能够成功打开文件，要么打开文件失败，这时，可以通过返回值区分“成功”和“失败”。

当然，myopen() 函数失败的原因可能很多，但不是本文关注的重点，本文更关心的是，该以何值表示“成功”，何值表示“失败”。

**按照C语言语法， 0 表示假，非零（常常用 1）表示真，那是否函数也用 0 返回值表示“失败”，1 返回值表示“成功”呢？**

# **行业“潜规则”**

C语言函数当然可以使用返回值 0 表示“失败”，用返回值 1 表示“成功”。

**事实上，C语言函数用什么样的返回值表示成功或者失败，只是一种人为的约定，函数的调用者遵守这个“约定”就可以了。**

C语言也有“行业潜规则”，不过，对于一般的函数，大多数C语言程序员常常使用返回值 0 表示成功，非零值表示失败。

因此， **如果希望我们定义的函数能够被大多数人愉快的使用，最好不要反其道而行，遵守“行业潜规则”更好一点。**

仔细考虑下，其实C语言函数使用返回值 0 表示成功是有原因的。更一般的C语言函数返回值并不一定只有两种可能值（成功/失败），它可能还会返回对应错误原因的返回值。

总之，函数成功只有一种可能，函数失败却有多种可能。

实数要么是 0，要么非 0，因此可以将 0 看作一个比较特殊的“唯一”数值，使用 0 这个“唯一”的返回值，表示唯一的“成功”，多种非零的返回值，表示多种原因的失败，无疑更好一些。

**当然，我们也可以说“实数要么是 1，要么非 1”，不过这显然也不是“行业潜规则”。**

例如我们可以规定，如果 myopen() 函数因为“文件或者目录不存在”的原因失败，返回 -1，如果因为“权限不够”的原因失败，则返回 -2。

\-1 和 -2 都是“非零值”，而成功作为失败的对立面，也即“非零值”的对立面，myopen() 函数使用返回值 0 表示成功无可厚非。

# **另一种行业“潜规则”**

当然，C语言程序员中还有一种“行业潜规则”。

如果定义的函数是个布尔函数，也即返回值显式的使用类似于 bool 关键字定义，或者函数名类似于 is\_true()，那么显然此时应该遵守C语言语法，使用“真”值表示成功，“假”值表示失败。

```bash
if( is_true() )  printf("true\n");
```

请看上面这两行C语言代码，显然，遵守C语言语法的布尔函数更便于程序员写出布尔判断类的代码。

**小结**

本文主要讨论了C语言程序开发中关于函数返回值的问题。可见，使用什么样的返回值表示成功，什么用的返回值表示失败，其实只是一种人为约定。

只不过，如果希望我们编写的代码能够被大多数同行愉快的使用，最好遵守下“行业潜规则”。

当然了，若是希望我们的C语言代码应用性更广，则可以使用<stdlib.h>标准头文件里预先定义好的 EXIT\_SUCCESS 和 EXIT\_FAILURE 宏。

*文章来源于，让我佩服的工程师网友！*