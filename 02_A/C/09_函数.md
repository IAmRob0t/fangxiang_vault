---
tags:
  - c
---
* å°±æ˜¯ä¸€ç³»åˆ—çš„æŒ‡ä»¤ï¼šä¸€ç³»åˆ—æœºå™¨ç 
* ä¸ºä»€ä¹ˆå­å‡½æ•°æ— æ³•ä¿®æ”¹å®å‚ï¼Ÿ
* è°ƒç”¨å‡½æ•°ï¼šè®© CPU çš„ PC å¯„å­˜å™¨ç­‰äº"ä¸€ç³»åˆ—æœºå™¨ç "çš„é¦–åœ°å€ï¼Œå°±æ˜¯å‡½æ•°åœ°å€

---

# å‡½æ•°çš„å®šä¹‰å’Œè°ƒç”¨

æ¯ä¸ªå‡½æ•°éƒ½æœ‰ä¸€ä¸ªå¸¦æœ‰èŠ±æ‹¬å·çš„æ‰§è¡Œéƒ¨åˆ†ï¼Œç§°ä¸ºå‡½æ•°ä½“ï¼ˆbodyï¼‰ã€‚å› æ­¤ï¼Œæ¯ä¸ªå‡½æ•°ä½“éƒ½æ˜¯ä¸€ä¸ª [[05_é€‰æ‹©è¯­å¥#å¤åˆè¯­å¥|å¤åˆè¯­å¥ï¼ˆ 5.2.1 èŠ‚ï¼‰]] ã€‚

## å‡½æ•°å®šä¹‰

ä¸‹åˆ—è§„åˆ™ç”¨æ¥ç®¡ç†è¿”å›ç±»å‹ï¼š
- å‡½æ•°ä¸èƒ½è¿”å›æ•°ç»„ï¼Œä½†å…³äºè¿”å›ç±»å‹æ²¡æœ‰å…¶ä»–é™åˆ¶ã€‚
- å¦‚æœçœç•¥è¿”å›ç±»å‹ï¼ŒC89 ä¼šå‡å®šå‡½æ•°è¿”å›å€¼çš„ç±»å‹æ˜¯ `int` ç±»å‹ï¼Œ ä½†åœ¨ C99 ä¸­è¿™æ˜¯ä¸åˆæ³•çš„ã€‚

---

ä¸€äº›ç¨‹åºå‘˜ä¹ æƒ¯æŠŠè¿”å›ç±»å‹æ”¾åœ¨å‡½æ•°åçš„ä¸Šè¾¹ï¼š

```c
double 
average (double a, double)
{
	return (a + b) / 2;
}
```

å¦‚æœè¿”å›ç±»å‹å¾ˆå†—é•¿ï¼Œæ¯”å¦‚ `unsigned long int` ç±»å‹ï¼Œé‚£ä¹ˆæŠŠè¿”å›ç±»å‹å•ç‹¬æ”¾åœ¨ä¸€è¡Œæ˜¯éå¸¸æœ‰ç”¨çš„ã€‚

---

å¯¹äºè¿”å›ç±»å‹ä¸º `void` çš„å‡½æ•°ï¼Œå…¶å‡½æ•°ä½“å¯ä»¥åªæ˜¯ä¸€å¯¹èŠ±æ‹¬å·ï¼ˆç©ºçš„å¤åˆè¯­å¥ï¼‰ï¼š

```c
void print_pun (void)
{

}
```

ç¨‹åºå¼€å‘è¿‡ç¨‹ä¸­ç•™ä¸‹ç©ºå‡½æ•°ä½“æ˜¯æœ‰æ„ä¹‰çš„ã€‚å› ä¸ºæ²¡æœ‰æ—¶é—´å®Œæˆå‡½æ•°ï¼Œæ‰€ä»¥ä¸ºå®ƒé¢„ç•™ä¸‹ç©ºé—´ï¼Œä»¥åå¯ä»¥å†å›æ¥ç¼–å†™å®ƒçš„å‡½æ•°ä½“ã€‚

## å‡½æ•°è°ƒç”¨

> [!warning] 
> å¦‚æœä¸¢å¤±åœ†æ‹¬å·ï¼Œé‚£ä¹ˆå°†æ— æ³•è¿›è¡Œå‡½æ•°è°ƒç”¨ï¼š
> ```c
> print_pun; /*** WRONG ***/
> ```
> è¿™æ ·çš„ç»“æœæ˜¯åˆæ³•ï¼ˆä½†æ²¡æœ‰æ„ä¹‰ï¼‰çš„è¡¨è¾¾å¼è¯­å¥ï¼Œè™½ç„¶çœ‹ä¸Šå»æ­£ç¡®ï¼Œä½†æ˜¯ä¸èµ·ä»»ä½•ä½œç”¨ã€‚ä¸€äº›ç¼–è¯‘å™¨ä¼šå‘å‡ºä¸€æ¡ç±»ä¼¼â€œstatement with no effectâ€çš„è­¦å‘Šã€‚

### åˆ¤å®šç´ æ•°

```c
/* Tests whether a number is prime */

#include <stdbool.h> /* c99 only */
#include <stdio.h>

bool is_prime(int n)
{
	int divisor;
	if (n <= 1)
		return false;
	for (divisor = 2; divisor * divisor <= n; divisor++)
		if (n % divisor == 0)
			return false;
	
	return true;
}

int main(void)
{
	int n;
	
	printf("Enter a number: ");
	scanf("%d", &n);
	if (is_prime(n))
		printf("Prime\n");
	else
		printf("Not prime\n");
	
	return 0;
}
```

æ³¨æ„ï¼Œ`main` å‡½æ•°åŒ…å«ä¸€ä¸ªåä¸º `n` çš„å˜é‡ï¼Œè€Œ `is_prime` å‡½æ•°çš„å½¢å¼å‚æ•°ä¹Ÿå« `n`ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œ åœ¨ä¸€ä¸ªå‡½æ•°ä¸­å¯ä»¥å£°æ˜ä¸å¦ä¸€ä¸ªå‡½æ•°ä¸­çš„å˜é‡åŒåçš„å˜é‡ã€‚è¿™ä¸¤ä¸ªå˜é‡åœ¨å†…å­˜ä¸­çš„åœ°å€ä¸åŒï¼Œ æ‰€ä»¥ç»™å…¶ä¸­ä¸€ä¸ªå˜é‡èµ‹æ–°å€¼ä¸ä¼šå½±å“å¦ä¸€ä¸ªå˜é‡ã€‚ï¼ˆå½¢å¼å‚æ•°ä¹Ÿå…·æœ‰è¿™ä¸€æ€§è´¨ã€‚ï¼‰10.1 èŠ‚ä¼šæ›´è¯¦ç»†åœ°è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚

# å‡½æ•°å£°æ˜

å½“é‡åˆ° `main` å‡½æ•°ä¸­ç¬¬ä¸€ä¸ª `average` å‡½æ•°è°ƒç”¨æ—¶ï¼Œç¼–è¯‘å™¨æ²¡æœ‰ä»»ä½•å…³äº `average` å‡½æ•°çš„ä¿¡æ¯ï¼šç¼–è¯‘å™¨ä¸çŸ¥é“ `average` å‡½æ•°æœ‰å¤šå°‘å½¢å¼å‚æ•°ã€å½¢å¼å‚æ•°çš„ç±»å‹æ˜¯ä»€ä¹ˆï¼Œä¹Ÿä¸çŸ¥é“ `average` å‡½æ•°çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆç±»å‹ã€‚ä½†æ˜¯ï¼Œç¼–è¯‘å™¨ä¸ä¼šç»™å‡ºå‡ºé”™æ¶ˆæ¯ï¼Œè€Œæ˜¯å‡è®¾ `average` å‡½æ•°è¿”å› `int` å‹çš„å€¼ï¼ˆå›é¡¾ [[#å‡½æ•°å®šä¹‰|9.1 èŠ‚]] çš„å†…å®¹ï¼Œå¯ä»¥çŸ¥é“å‡½æ•°è¿”å›å€¼çš„ç±»å‹é»˜è®¤ä¸º `int` å‹ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥è¯´ç¼–è¯‘å™¨ä¸ºè¯¥å‡½æ•°åˆ›å»ºäº†ä¸€ä¸ªéšå¼å£°æ˜ï¼ˆimplicit declarationï¼‰ã€‚ç¼–è¯‘å™¨æ— æ³•æ£€æŸ¥ä¼ é€’ç»™ `average` çš„å®å‚ä¸ªæ•°å’Œå®å‚ç±»å‹ï¼Œåªèƒ½è¿›è¡Œé»˜è®¤å®å‚æå‡ï¼ˆ [[#å®é™…å‚æ•°|9.3 èŠ‚]] ï¼‰å¹¶æœŸå¾…æœ€å¥½çš„æƒ…å†µå‘ç”Ÿã€‚å½“ç¼–è¯‘å™¨åœ¨åé¢é‡åˆ° `average` çš„å®šä¹‰æ—¶ï¼Œå®ƒä¼šå‘ç°å‡½æ•°çš„è¿”å›ç±»å‹å®é™…ä¸Šæ˜¯ `double` è€Œä¸æ˜¯ `int`ï¼Œä»è€Œæˆ‘ä»¬å¾—åˆ°ä¸€æ¡å‡ºé”™æ¶ˆæ¯ã€‚

ä¸ºäº†é¿å…å®šä¹‰å‰è°ƒç”¨çš„é—®é¢˜ï¼Œä¸€ç§æ–¹æ³•æ˜¯ä½¿æ¯ä¸ªå‡½æ•°çš„å®šä¹‰éƒ½å‡ºç°åœ¨å…¶è°ƒç”¨ä¹‹å‰ã€‚å¯æƒœçš„æ˜¯ï¼Œæœ‰æ—¶å€™æ— æ³•è¿›è¡Œè¿™æ ·çš„å®‰æ’ï¼›è€Œä¸”å³ä½¿å¯ä»¥è¿™æ ·å®‰æ’ï¼Œç¨‹åºä¹Ÿä¼šå› ä¸ºå‡½æ•°å®šä¹‰çš„é¡ºåºä¸è‡ªç„¶è€Œéš¾ä»¥é˜…è¯»ã€‚

å¹¸è¿çš„æ˜¯ï¼ŒC è¯­è¨€æä¾›äº†ä¸€ç§æ›´å¥½çš„è§£å†³åŠæ³•ï¼šåœ¨è°ƒç”¨å‰å£°æ˜æ¯ä¸ªå‡½æ•°ã€‚å‡½æ•°å£°æ˜ï¼ˆfunction declarationï¼‰ä½¿å¾—ç¼–è¯‘å™¨å¯ä»¥å…ˆå¯¹å‡½æ•°è¿›è¡Œæ¦‚è¦æµè§ˆï¼Œè€Œå‡½æ•°çš„å®Œæ•´å®šä¹‰ä»¥åå†ç»™å‡ºã€‚å‡½æ•°å£°æ˜ç±»ä¼¼äºå‡½æ•°å®šä¹‰çš„ç¬¬ä¸€è¡Œï¼Œä¸åŒä¹‹å¤„æ˜¯åœ¨å…¶ç»“å°¾å¤„æœ‰åˆ†å·

ä¸ºäº†ä¸è¿‡å»çš„é‚£ç§åœ†æ‹¬å·å†…ä¸ºç©ºçš„å‡½æ•°å£°æ˜é£æ ¼ç›¸åŒºåˆ«ï¼Œæˆ‘ä»¬æŠŠæ­£åœ¨è®¨è®ºçš„è¿™ç±»å‡½æ•°å£°æ˜ç§°ä¸ºå‡½æ•°åŸå‹ï¼ˆfunction prototypeï¼‰ã€‚

å‡½æ•°åŸå‹ä¸éœ€è¦è¯´æ˜å‡½æ•°å½¢å¼å‚æ•°çš„åå­—ï¼Œåªè¦æ˜¾ç¤ºå®ƒä»¬çš„ç±»å‹å°±å¯ä»¥äº†ï¼š

```c
double average (double, double )
```

é€šå¸¸æœ€å¥½æ˜¯ä¸è¦çœç•¥å½¢å¼å‚æ•°çš„åå­—ï¼Œå› ä¸ºè¿™äº›åå­—å¯ä»¥è¯´æ˜æ¯ä¸ªå½¢å¼å‚æ•°çš„ç›®çš„ï¼Œå¹¶ä¸”æé†’ç¨‹åºå‘˜åœ¨å‡½æ•°è°ƒç”¨æ—¶å®é™…å‚æ•°çš„å‡ºç°æ¬¡åºã€‚å½“ç„¶ï¼Œ çœç•¥å½¢å¼å‚æ•°çš„åå­—ä¹Ÿæœ‰ä¸€å®šçš„é“ç†ï¼Œ æœ‰äº›ç¨‹åºå‘˜å–œæ¬¢è¿™æ ·åšã€‚

C99 éµå¾ªè¿™æ ·çš„è§„åˆ™ï¼šåœ¨è°ƒç”¨ä¸€ä¸ªå‡½æ•°ä¹‹å‰ï¼Œå¿…é¡»å…ˆå¯¹å…¶è¿›è¡Œå£°æ˜æˆ–å®šä¹‰ã€‚è°ƒç”¨å‡½æ•°æ—¶ï¼Œå¦‚æœæ­¤å‰ç¼–è¯‘å™¨æœªè§åˆ°è¯¥å‡½æ•°çš„å£°æ˜æˆ–å®šä¹‰ï¼Œä¼šå¯¼è‡´å‡ºé”™ã€‚

# å®é™…å‚æ•°

å½¢å¼å‚æ•° ï¼ˆparameterï¼‰å‡ºç°åœ¨å‡½æ•°å®šä¹‰ä¸­ï¼Œ å®ƒä»¬ä»¥å‡åå­—æ¥è¡¨ç¤ºå‡½æ•°è°ƒç”¨æ—¶éœ€è¦æä¾›çš„å€¼ï¼› å®é™…å‚æ•° ï¼ˆargumentï¼‰æ˜¯å‡ºç°åœ¨å‡½æ•°è°ƒç”¨ä¸­çš„è¡¨è¾¾å¼ã€‚

## å®é™…å‚æ•°çš„è½¬æ¢

C è¯­è¨€å…è®¸åœ¨å®é™…å‚æ•°çš„ç±»å‹ä¸å½¢å¼å‚æ•°çš„ç±»å‹ä¸åŒ¹é…çš„æƒ…å†µä¸‹è¿›è¡Œå‡½æ•°è°ƒç”¨ã€‚ç®¡ç†å¦‚ä½•è½¬æ¢å®é™…å‚æ•°çš„è§„åˆ™ä¸ç¼–è¯‘å™¨æ˜¯å¦åœ¨è°ƒç”¨å‰é‡åˆ°å‡½æ•°çš„åŸå‹ï¼ˆæˆ–è€…å‡½æ•°çš„å®Œæ•´å®šä¹‰ï¼‰æœ‰å…³ï¼š
- ç¼–è¯‘å™¨åœ¨è°ƒç”¨å‰é‡åˆ°åŸå‹ã€‚å°±åƒä½¿ç”¨èµ‹å€¼ä¸€æ ·ï¼Œæ¯ä¸ªå®é™…å‚æ•°çš„å€¼è¢«éšå¼åœ°è½¬æ¢æˆç›¸åº”å½¢å¼å‚æ•°çš„ç±»å‹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæŠŠ `int` ç±»å‹çš„å®é™…å‚æ•°ä¼ é€’ç»™æœŸæœ›å¾—åˆ° `double` ç±»å‹æ•°æ®çš„å‡½æ•°ï¼Œé‚£ä¹ˆå®é™…å‚æ•°ä¼šè¢«è‡ªåŠ¨è½¬æ¢æˆ `double` ç±»å‹ã€‚
- ç¼–è¯‘å™¨åœ¨è°ƒç”¨å‰æ²¡æœ‰é‡åˆ°åŸå‹ã€‚ç¼–è¯‘å™¨æ‰§è¡Œé»˜è®¤å®å‚æå‡ï¼š
	1. æŠŠ `float` ç±»å‹çš„å®é™…å‚æ•°è½¬æ¢æˆ `double` ç±»å‹ï¼›
	2. æ‰§è¡Œæ•´å€¼æå‡ï¼Œå³æŠŠ `char` ç±»å‹å’Œ `short` ç±»å‹çš„å®é™…å‚æ•°è½¬æ¢æˆ `int` ç±»å‹ã€‚ï¼ˆ C99 å®ç°äº†æ•´æ•°æå‡ã€‚ï¼‰

## æ•°ç»„å‹å®é™…å‚æ•°

å½“å½¢å¼å‚æ•°æ˜¯ä¸€ç»´æ•°ç»„æ—¶ï¼Œå¯ä»¥ï¼ˆè€Œä¸”æ˜¯é€šå¸¸æƒ…å†µä¸‹ï¼‰ä¸è¯´æ˜æ•°ç»„çš„é•¿åº¦ã€‚å‡½æ•°å¦‚ä½•çŸ¥é“æ•°ç»„æ˜¯å¤šé•¿å‘¢ï¼Ÿå¯æƒœçš„æ˜¯ï¼ŒC è¯­è¨€æ²¡æœ‰ä¸ºå‡½æ•°æä¾›ä»»ä½•ç®€ä¾¿çš„æ–¹æ³•æ¥ç¡®å®šä¼ é€’ç»™å®ƒçš„æ•°ç»„çš„é•¿åº¦ï¼›å¦‚æœå‡½æ•°éœ€è¦ï¼Œæˆ‘ä»¬å¿…é¡»æŠŠé•¿åº¦ä½œä¸ºé¢å¤–çš„å‚æ•°æä¾›å‡ºæ¥ã€‚

> [!warning] 
> è™½ç„¶å¯ä»¥ç”¨è¿ç®—ç¬¦ `sizeof` è®¡ç®—å‡ºæ•°ç»„å˜é‡çš„é•¿åº¦ï¼Œä½†æ˜¯å®ƒæ— æ³•ç»™å‡ºå…³äºæ•°ç»„å‹å½¢å¼å‚æ•°çš„æ­£ç¡®ç­”æ¡ˆï¼š
> ```c
> int f(int a[])
> {
> 	int len = sizeof(a) / sizeof(a[0]);
> 	/*** WRONG: not the number of elements in a ***/
> 	...
> }
> ```
> 12.3 èŠ‚è§£é‡Šäº†åŸå› ã€‚

é€šå¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœæ„¿æ„çš„è¯ï¼Œåˆ™å¯ä»¥çœç•¥å½¢å¼å‚æ•°çš„åå­—ï¼š

```c
int sum_array (int [], int);
```

æ³¨æ„ï¼Œåœ¨æŠŠæ•°ç»„åä¼ é€’ç»™å‡½æ•°æ—¶ï¼Œä¸è¦åœ¨æ•°ç»„åçš„åè¾¹æ”¾ç½®æ–¹æ‹¬å·ï¼š

```c
total = sum_array(b[], LEN); /*** WRONG ***/
```

æ•°ç»„å‹å®é™…å‚æ•°çš„å…ƒç´ å¯ä»¥ä¿®æ”¹ï¼Œè¿™ä¼¼ä¹ä¸ C è¯­è¨€ä¸­å®é™…å‚æ•°çš„å€¼ä¼ é€’ç›¸çŸ›ç›¾ã€‚äº‹å®ä¸Šè¿™å¹¶ä¸çŸ›ç›¾ï¼Œä½†ç°åœ¨æ²¡æ³•è§£é‡Šï¼Œç­‰åˆ° 12.3 èŠ‚å†è§£é‡Šã€‚

---

å¦‚æœå½¢å¼å‚æ•°æ˜¯å¤šç»´æ•°ç»„ï¼Œå£°æ˜å‚æ•°æ—¶åªèƒ½çœç•¥ç¬¬ä¸€ç»´çš„é•¿åº¦ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¿®æ”¹ `sum_array` å‡½æ•°ä½¿å¾— `a` æ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œæˆ‘ä»¬å¯ä»¥ä¸æŒ‡å‡ºè¡Œçš„æ•°é‡ï¼Œä½†æ˜¯å¿…é¡»æŒ‡å®šåˆ—çš„æ•°é‡ï¼š

```c
#define LEN 10

int sum_two_dimensional_array(int a[][LEN], int n)
{
	int i, j, sum = 0;
	
	for (i = 0; i < n; i++)
		for (j = 0; j < LEN; j++)
			sum += a[i][j];
	
	return sum;
}
```

ä¸èƒ½ä¼ é€’å…·æœ‰ä»»æ„åˆ—æ•°çš„å¤šç»´æ•°ç»„æ˜¯å¾ˆè®¨åŒçš„ã€‚å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬ç»å¸¸å¯ä»¥é€šè¿‡ä½¿ç”¨æŒ‡é’ˆæ•°ç»„ ï¼ˆ 13.7 èŠ‚ï¼‰è§£å†³è¿™ç§å›°éš¾ã€‚C99 ä¸­çš„å˜é•¿æ•°ç»„å½¢å¼å‚æ•°åˆ™æä¾›äº†ä¸€ç§æ›´å¥½çš„è§£å†³æ–¹æ¡ˆã€‚

## å˜é•¿æ•°ç»„å½¢å¼å‚æ•°

å¦‚æœä½¿ç”¨å˜é•¿æ•°ç»„å½¢å¼å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥æ˜¾å¼åœ°è¯´æ˜æ•°ç»„ `a` çš„é•¿åº¦å°±æ˜¯ `n` ï¼š

```c
int sum_array (int n, int a[n])
{
	...
}
```

ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆnï¼‰çš„å€¼ç¡®å®šäº†ç¬¬äºŒä¸ªå‚æ•°ï¼ˆaï¼‰çš„é•¿åº¦ã€‚æ³¨æ„ï¼Œè¿™é‡Œäº¤æ¢äº†å½¢å¼å‚æ•°çš„é¡ºåºï¼Œ ä½¿ç”¨å˜é•¿æ•°ç»„å½¢å¼å‚æ•°æ—¶å‚æ•°çš„é¡ºåºå¾ˆé‡è¦ã€‚

å¯¹äºæ–°ç‰ˆæœ¬çš„ `sum_array` å‡½æ•°ï¼Œå…¶å‡½æ•°åŸå‹æœ‰å¥½å‡ ç§å†™æ³•ã€‚ä¸€ç§å†™æ³•æ˜¯ä½¿å…¶çœ‹èµ·æ¥è·Ÿå‡½æ•°å®šä¹‰ä¸€æ ·ï¼š

```c
int sum_array(int n, int a[n]); /* Version 1 */
```

å¦ä¸€ç§å†™æ³•æ˜¯ç”¨ `*`ï¼ˆæ˜Ÿå·ï¼‰å–ä»£æ•°ç»„é•¿åº¦ï¼š

```c
int sum_array(int n, int a[*]); /* Version 2a */
```

ä½¿ç”¨ `*` çš„ç†ç”±å¦‚ä¸‹ã€‚å‡½æ•°å£°æ˜æ—¶ï¼Œå½¢å¼å‚æ•°çš„åå­—æ˜¯å¯é€‰çš„ã€‚å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°å®šä¹‰è¢«çœç•¥äº†ï¼Œé‚£ä¹ˆå°±æ²¡æœ‰åŠæ³•è¯´æ˜æ•°ç»„ a çš„é•¿åº¦æ˜¯ nï¼Œè€Œæ˜Ÿå·çš„ä½¿ç”¨åˆ™ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªçº¿ç´¢â€”â€”æ•°ç»„çš„é•¿åº¦ä¸å½¢å¼å‚æ•°åˆ—è¡¨ä¸­å‰é¢çš„å‚æ•°ç›¸å…³ï¼š

```c
int sum_array(int, int [*]); /* Version 2b */
```

å¦å¤–ï¼Œæ–¹æ‹¬å·ä¸ºç©ºä¹Ÿæ˜¯åˆæ³•çš„ã€‚åœ¨å£°æ˜æ•°ç»„å‚æ•°æ—¶æˆ‘ä»¬ç»å¸¸è¿™ä¹ˆåšï¼š

```c
int sum_array(int n, int a[]); /* Version 3a */
int sum_array(int, int []); /* Version 3b */
```

ä½†æ˜¯è®©æ‹¬å·ä¸ºç©ºä¸æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ï¼Œå› ä¸ºè¿™æ ·å¹¶æ²¡æœ‰è¯´æ˜ n å’Œ a ä¹‹é—´çš„å…³ç³»ã€‚

ä¸€èˆ¬æ¥è¯´ï¼Œå˜é•¿æ•°ç»„å½¢å¼å‚æ•°çš„é•¿åº¦å¯ä»¥æ˜¯ä»»æ„è¡¨è¾¾å¼ã€‚

---

ä¸€ç»´å˜é•¿æ•°ç»„å½¢å¼å‚æ•°é€šè¿‡æŒ‡å®šæ•°ç»„å‚æ•°çš„é•¿åº¦ä½¿å¾—å‡½æ•°çš„å£°æ˜å’Œå®šä¹‰æ›´å…·æè¿°æ€§ã€‚ä½†æ˜¯ï¼Œç”±äºæ²¡æœ‰è¿›è¡Œé¢å¤–çš„é”™è¯¯æ£€æµ‹ï¼Œæ•°ç»„å‚æ•°ä»ç„¶æœ‰å¯èƒ½å¤ªé•¿æˆ–å¤ªçŸ­ã€‚

å¦‚æœå˜é•¿æ•°ç»„å‚æ•°æ˜¯å¤šç»´çš„ï¼Œåˆ™æ›´åŠ å®ç”¨ã€‚ä¹‹å‰ï¼Œæˆ‘ä»¬å°è¯•è¿‡å†™ä¸€ä¸ªå‡½æ•°æ¥å®ç°äºŒç»´æ•°ç»„ä¸­å…ƒç´ ç›¸åŠ ã€‚åŸå§‹çš„å‡½æ•°è¦æ±‚æ•°ç»„çš„åˆ—æ•°å›ºå®šã€‚å¦‚æœä½¿ç”¨å˜é•¿æ•°ç»„å½¢å¼å‚æ•°ï¼Œåˆ™å¯ä»¥æ¨å¹¿åˆ°ä»»æ„åˆ—æ•°çš„æƒ…å†µï¼š

```c
int sum_two_dimensional_array(int n, int m, int a[n][m])
{
	int i, j, sum = 0;
	
	for (i = 0; i < n; i++)
		for (j = 0; j < m; j++)
			sum += a[i][j];
			
	return sum;
}
```

è¿™ä¸ªå‡½æ•°çš„åŸå‹å¯ä»¥æ˜¯ä»¥ä¸‹å‡ ç§ï¼š

```c
int sum_two_dimensional_array(int n, int m, int a[n][m]);
int sum_two_dimensional_array(int n, int m, int a[*][*]);
int sum_two_dimensional_array(int n, int m, int a[][m]);
int sum_two_dimensional_array(int n, int m, int a[][*]);
```

## åœ¨æ•°ç»„å‚æ•°å£°æ˜ä¸­ä½¿ç”¨ `static` ï¼ˆC99ï¼‰

C99 å…è®¸åœ¨æ•°ç»„å‚æ•°å£°æ˜ä¸­ä½¿ç”¨å…³é”®å­— `static`ï¼ˆC99 ä¹‹å‰ `static` å…³é”®å­—å°±å·²ç»å­˜åœ¨ï¼Œ [[18_å£°æ˜#`static` å­˜å‚¨ç±»å‹|18.2 èŠ‚]] ä¼šè®¨è®ºå®ƒçš„ä¼ ç»Ÿç”¨æ³•ï¼‰ã€‚

åœ¨ä¸‹é¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œå°† `static` æ”¾åœ¨æ•°å­— 3 ä¹‹å‰ï¼Œè¡¨æ˜æ•°ç»„ a çš„é•¿åº¦è‡³å°‘å¯ä»¥ä¿è¯æ˜¯ 3ï¼š

```c
int sum_array (int a[static 3], int n)
{
	...
}
```

è¿™æ ·ä½¿ç”¨ `static` ä¸ä¼šå¯¹ç¨‹åºçš„è¡Œä¸ºæœ‰ä»»ä½•å½±å“ã€‚`static` çš„å­˜åœ¨åªä¸è¿‡æ˜¯ä¸€ä¸ªâ€œæç¤ºâ€ï¼ŒC ç¼–è¯‘å™¨å¯ä»¥æ®æ­¤ç”Ÿæˆæ›´å¿«çš„æŒ‡ä»¤æ¥è®¿é—®æ•°ç»„ã€‚ï¼ˆå¦‚æœç¼–è¯‘å™¨çŸ¥é“æ•°ç»„æ€»æ˜¯å…·æœ‰æŸä¸ªæœ€å°å€¼ï¼Œé‚£ä¹ˆå®ƒå¯ä»¥åœ¨å‡½æ•°è°ƒç”¨æ—¶é¢„å…ˆä»å†…å­˜ä¸­å–å‡ºè¿™äº›å…ƒç´ å€¼ï¼Œè€Œä¸æ˜¯åœ¨é‡åˆ°å‡½æ•°å†…éƒ¨éœ€è¦ç”¨åˆ°è¿™äº›å…ƒç´ çš„è¯­å¥æ—¶æ‰å–å‡ºç›¸åº”çš„å€¼ã€‚

æœ€åï¼Œå…³äº `static` è¿˜æœ‰ä¸€ç‚¹å€¼å¾—æ³¨æ„ï¼šå¦‚æœæ•°ç»„å‚æ•°æ˜¯å¤šç»´çš„ï¼Œ`static` ä»…å¯ç”¨äºç¬¬ä¸€ç»´ ï¼ˆä¾‹å¦‚ï¼ŒæŒ‡å®šäºŒç»´æ•°ç»„çš„è¡Œæ•°ï¼‰ã€‚

## å¤åˆå­—é¢é‡ï¼ˆC99ï¼‰

å¤åˆå­—é¢é‡æ˜¯é€šè¿‡æŒ‡å®šå…¶åŒ…å«çš„å…ƒç´ è€Œåˆ›å»ºçš„æ²¡æœ‰åå­—çš„æ•°ç»„ã€‚ä¸‹é¢è°ƒç”¨ `sum_array` å‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯ä¸€ä¸ªå¤åˆå­—é¢é‡ï¼š

```c
total = sum_array((int []){3, 0, 3, 4, 1}, 5);
```

ä¸€èˆ¬æ¥è¯´ï¼Œå¤åˆå­—é¢é‡çš„æ ¼å¼å¦‚ä¸‹ï¼šå…ˆåœ¨ä¸€å¯¹åœ†æ‹¬å·å†…ç»™å®šç±»å‹åï¼Œéšåæ˜¯ä¸€ä¸ªåˆå§‹åŒ–å™¨ï¼Œç”¨æ¥æŒ‡å®šåˆå§‹å€¼ã€‚å› æ­¤ï¼Œå¯ä»¥åœ¨å¤åˆå­—é¢é‡çš„åˆå§‹åŒ–å™¨ä¸­ä½¿ç”¨æŒ‡ç¤ºå™¨ï¼ˆ [[08_æ•°ç»„#æŒ‡ç¤ºå™¨ (C99)|8.1 èŠ‚]] ï¼‰ä¸€æ ·ï¼Œ è€Œä¸”åŒæ ·å¯ä»¥ä¸æä¾›å®Œå…¨çš„åˆå§‹åŒ–ï¼ˆæœªåˆå§‹åŒ–çš„å…ƒç´ é»˜è®¤è¢«åˆå§‹åŒ–ä¸º 0ï¼‰ã€‚

å¤åˆå­—é¢é‡ä¸º [[04_è¡¨è¾¾å¼#å·¦å€¼|å·¦å€¼ï¼ˆ 4.2 èŠ‚ï¼‰]] ï¼Œæ‰€ä»¥å…¶å…ƒç´ çš„å€¼å¯ä»¥æ”¹å˜ã€‚å¦‚æœè¦æ±‚å…¶å€¼ä¸ºâ€œåªè¯»â€ï¼Œå¯ä»¥åœ¨ç±»å‹å‰åŠ ä¸Š `const`ï¼Œå¦‚ `(const int []){5, 4}` ã€‚

# `return` è¯­å¥

å¦‚æœæ²¡æœ‰ç»™å‡ºè¡¨è¾¾å¼ï¼Œ`return` è¯­å¥å¯ä»¥å‡ºç°åœ¨è¿”å›ç±»å‹ä¸º `void` çš„å‡½æ•°ä¸­ï¼š

```c
return; /* return in a void function */
```

# ç¨‹åºç»ˆæ­¢

çœç•¥å‡½æ•°çš„è¿”å›ç±»å‹åœ¨ C99 ä¸­æ˜¯ä¸åˆæ³•çš„ï¼Œæ‰€ä»¥æœ€å¥½ä¸è¦è¿™æ ·åšã€‚çœç•¥ `main` å‡½æ•°å‚æ•°åˆ—è¡¨ä¸­çš„ `void` æ˜¯åˆæ³•çš„ï¼Œä½†æ˜¯ï¼ˆä»ç¼–ç¨‹é£æ ¼çš„è§’åº¦çœ‹ï¼‰æœ€å¥½æ˜¾å¼åœ°è¡¨æ˜ `main` å‡½æ•°æ²¡æœ‰å‚æ•°ã€‚ï¼»åé¢å°†çœ‹åˆ°ï¼Œ`main` å‡½æ•°æœ‰æ—¶æ˜¯æœ‰ä¸¤ä¸ªå‚æ•°çš„ï¼Œé€šå¸¸åä¸º `argc` å’Œ `argv`ï¼ˆ 13.7 èŠ‚ï¼‰ã€‚

`main` å‡½æ•°è¿”å›çš„å€¼æ˜¯çŠ¶æ€ç ï¼Œåœ¨æŸäº›æ“ä½œç³»ç»Ÿä¸­ç¨‹åºç»ˆæ­¢æ—¶å¯ä»¥æ£€æµ‹åˆ°çŠ¶æ€ç ã€‚å¦‚æœç¨‹åºæ­£å¸¸ç»ˆæ­¢ï¼Œ`main` å‡½æ•°åº”è¯¥è¿”å› 0ï¼›ä¸ºäº†è¡¨ç¤ºå¼‚å¸¸ç»ˆæ­¢ï¼Œ`main` å‡½æ•°åº”è¯¥è¿”å›é 0 çš„å€¼ã€‚ï¼ˆå®é™…ä¸Šï¼Œè¿™ä¸€è¿”å›å€¼ä¹Ÿå¯ä»¥ç”¨äºå…¶ä»–ç›®çš„ã€‚ï¼‰å³ä½¿ä¸æ‰“ç®—ä½¿ç”¨çŠ¶æ€ç ï¼Œç¡®ä¿æ¯ä¸ª C ç¨‹åºéƒ½è¿”å›çŠ¶æ€ç ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å®è·µï¼Œå› ä¸ºä»¥åè¿è¡Œç¨‹åºçš„äººå¯èƒ½éœ€è¦æµ‹è¯•çŠ¶æ€ç ã€‚

### `exit` å‡½æ•°

åœ¨ `main` å‡½æ•°ä¸­æ‰§è¡Œ `return` è¯­å¥æ˜¯ç»ˆæ­¢ç¨‹åºçš„ä¸€ç§æ–¹æ³•ï¼Œå¦ä¸€ç§æ–¹æ³•æ˜¯è°ƒç”¨ `exit` å‡½æ•°ï¼Œ æ­¤å‡½æ•°å±äº `<stdlib.h>` å¤´ï¼ˆ 26.2 èŠ‚ï¼‰ã€‚ä¼ é€’ç»™ `exit` å‡½æ•°çš„å®é™…å‚æ•°å’Œ `main` å‡½æ•°çš„è¿”å›å€¼å…·æœ‰ç›¸åŒçš„å«ä¹‰ï¼šä¸¤è€…éƒ½è¯´æ˜ç¨‹åºç»ˆæ­¢æ—¶çš„çŠ¶æ€ã€‚ä¸ºäº†è¡¨ç¤ºæ­£å¸¸ç»ˆæ­¢ï¼Œä¼ é€’ 0ï¼š

```c
exit(0); /* normal termination */
```

å› ä¸º 0 æœ‰ç‚¹æ¨¡ç³Šï¼Œæ‰€ä»¥ C è¯­è¨€å…è®¸ç”¨ `EXIT_SUCCESS` æ¥ä»£æ›¿ï¼ˆæ•ˆæœæ˜¯ç›¸åŒçš„ï¼‰ï¼š

```c
exit(EXIT_SUCCESS); /* normal termination */
```

ä¼ é€’ `EXIT_FAILURE` è¡¨ç¤ºå¼‚å¸¸ç»ˆæ­¢ï¼š

```c
exit(EXIT_FAILURE); /* abnormal termination */
```

`EXIT_SUCCESS` å’Œ `EXIT_FAILURE` éƒ½æ˜¯å®šä¹‰åœ¨ `<stdlib.h>` ä¸­çš„å®ã€‚`EXIT_SUCCESS` å’Œ `EXIT_FAILURE` çš„å€¼éƒ½æ˜¯ç”±å®ç°å®šä¹‰çš„ï¼Œé€šå¸¸åˆ†åˆ«æ˜¯ 0 å’Œ 1ã€‚

`return` è¯­å¥å’Œ `exit` å‡½æ•°ä¹‹é—´çš„å·®å¼‚æ˜¯ï¼Œä¸ç®¡å“ªä¸ªå‡½æ•°è°ƒç”¨ `exit` å‡½æ•°éƒ½ä¼šå¯¼è‡´ç¨‹åºç»ˆæ­¢ï¼Œ `return` è¯­å¥ä»…å½“ç”± `main` å‡½æ•°è°ƒç”¨æ—¶æ‰ä¼šå¯¼è‡´ç¨‹åºç»ˆæ­¢ã€‚ä¸€äº›ç¨‹åºå‘˜åªä½¿ç”¨ `exit` å‡½æ•°ï¼Œä»¥ä¾¿æ›´å®¹æ˜“å®šä½ç¨‹åºä¸­çš„å…¨éƒ¨é€€å‡ºç‚¹ã€‚

# é€’å½’ #æœªç†è§£

æœ‰äº›ç¼–ç¨‹è¯­è¨€æåº¦ä¾èµ–é€’å½’ï¼Œå¦ä¸€äº›ç¼–ç¨‹è¯­è¨€åˆ™ç”šè‡³ä¸å…è®¸ä½¿ç”¨é€’å½’ã€‚C è¯­è¨€ä»‹äºä¸¤è€…çš„ä¸­é—´ï¼š å®ƒå…è®¸é€’å½’ï¼Œä½†æ˜¯å¤§å¤šæ•° C ç¨‹åºå‘˜å¹¶ä¸ç»å¸¸ä½¿ç”¨é€’å½’ã€‚

### å¿«é€Ÿæ’åºç®—æ³•

å®é™…ä¸Šï¼Œé€’å½’ç»å¸¸ä½œä¸ºåˆ†æ²»æ³•ï¼ˆdivide-and-conquerï¼‰çš„ç»“æœè‡ªç„¶åœ°å‡ºç°ã€‚è¿™ç§ç§°ä¸ºåˆ†æ²»æ³•çš„ç®—æ³•è®¾è®¡æ–¹æ³•æŠŠä¸€ä¸ªå¤§é—®é¢˜åˆ’åˆ†æˆå¤šä¸ªè¾ƒå°çš„é—®é¢˜ï¼Œç„¶åé‡‡ç”¨ç›¸åŒçš„ç®—æ³•åˆ†åˆ«è§£å†³è¿™äº›å°é—®é¢˜ã€‚åˆ†æ²»æ³•çš„ç»å…¸ç¤ºä¾‹å°±æ˜¯æµè¡Œçš„æ’åºç®—æ³•â€”â€”å¿«é€Ÿæ’åºï¼ˆquicksortï¼‰ã€‚

å¿«é€Ÿæ’åºç®—æ³•çš„æ“ä½œå¦‚ä¸‹ï¼ˆä¸ºäº†ç®€åŒ–ï¼Œå‡è®¾è¦æ’åºçš„æ•°ç»„çš„ä¸‹æ ‡ä» 1 åˆ° nï¼‰:
1. é€‰æ‹©æ•°ç»„å…ƒç´  eï¼ˆä½œä¸ºâ€œåˆ†å‰²å…ƒç´ â€ï¼‰ï¼Œç„¶åé‡æ–°æ’åˆ—æ•°ç»„ï¼Œä½¿å¾—å…ƒç´ ä» 1 ä¸€ç›´åˆ° i-1 éƒ½æ˜¯å°äºæˆ–ç­‰äº e çš„ï¼Œå…ƒç´  i åŒ…å« eï¼Œè€Œå…ƒç´ ä» i+1 ä¸€ç›´åˆ° n éƒ½æ˜¯å¤§äºæˆ–ç­‰äº e çš„ã€‚
2. é€šè¿‡é€’å½’åœ°é‡‡ç”¨å¿«é€Ÿæ’åºæ–¹æ³•ï¼Œå¯¹ä» 1 åˆ° i-1 çš„å…ƒç´ è¿›è¡Œæ’åºã€‚
3. é€šè¿‡é€’å½’åœ°é‡‡ç”¨å¿«é€Ÿæ’åºæ–¹æ³•ï¼Œå¯¹ä» i+1 åˆ° n çš„å…ƒç´ è¿›è¡Œæ’åºã€‚

æ‰§è¡Œå®Œç¬¬ (1) æ­¥åï¼Œå…ƒç´  e å¤„åœ¨æ­£ç¡®çš„ä½ç½®ä¸Šã€‚å› ä¸º e å·¦ä¾§çš„å…ƒç´ å…¨éƒ½æ˜¯å°äºæˆ–ç­‰äº e çš„ï¼Œ æ‰€ä»¥ç¬¬ (2) æ­¥å¯¹è¿™äº›å…ƒç´ è¿›è¡Œæ’åºæ—¶ï¼Œè¿™äº›å°äºæˆ–ç­‰äº e çš„å…ƒç´ ä¹Ÿä¼šå¤„åœ¨æ­£ç¡®çš„ä½ç½®ä¸Šã€‚ç±»ä¼¼çš„æ¨ç†ä¹Ÿå¯ä»¥åº”ç”¨äº e å³ä¾§çš„å…ƒç´ ã€‚

æ˜¾ç„¶å¿«é€Ÿæ’åºä¸­çš„ç¬¬ (1) æ­¥æ˜¯å¾ˆå…³é”®çš„ã€‚æœ‰è®¸å¤šç§æ–¹æ³•å¯ä»¥ç”¨æ¥åˆ†å‰²æ•°ç»„ï¼Œæœ‰äº›æ–¹æ³•æ¯”å…¶ä»–çš„æ–¹æ³•å¥½å¾ˆå¤šã€‚ä¸‹é¢å°†é‡‡ç”¨çš„æ–¹æ³•æ˜¯å¾ˆå®¹æ˜“ç†è§£çš„ï¼Œä½†å®ƒä¸æ˜¯ç‰¹åˆ«é«˜æ•ˆã€‚ä¸‹é¢é¦–å…ˆå°†æ¦‚æ‹¬åœ°æè¿°åˆ†å‰²ç®—æ³•ï¼Œç¨åä¼šæŠŠè¿™ç§ç®—æ³•ç¿»è¯‘æˆ C ä»£ç ã€‚

![[Cè¯­è¨€ç¨‹åºè®¾è®¡ï¼šç°ä»£æ–¹æ³•ï¼ˆç¬¬2ç‰ˆâ€¢ä¿®è®¢ç‰ˆï¼‰.pdf#page=180&rect=81,53,456,540|Cè¯­è¨€ç¨‹åºè®¾è®¡ï¼šç°ä»£æ–¹æ³•ï¼ˆç¬¬2ç‰ˆâ€¢ä¿®è®¢ç‰ˆï¼‰, p.159|692]]

### å¿«é€Ÿæ’åº

å…ˆæ¥å¼€å‘ä¸€ä¸ªåä¸º `quicksort` çš„é€’å½’å‡½æ•°ï¼Œæ­¤å‡½æ•°é‡‡ç”¨å¿«é€Ÿæ’åºç®—æ³•å¯¹æ•°ç»„å…ƒç´ è¿›è¡Œæ’åºã€‚ä¸ºäº†æµ‹è¯•å‡½æ•°ï¼Œå°†ç”± `main` å‡½æ•°å¾€æ•°ç»„ä¸­è¯»å…¥ 10 ä¸ªå…ƒç´ ï¼Œè°ƒç”¨ `quicksort` å‡½æ•°å¯¹è¯¥æ•°ç»„è¿›è¡Œæ’åºï¼Œç„¶åæ˜¾ç¤ºæ•°ç»„ä¸­çš„å…ƒç´ ï¼š

```c
Enter 10 numbers to be sorted: 9 16 47 82 4 66 12 3 25 51
In sorted order: 3 4 9 12 16 25 47 51 66 82
```

å› ä¸ºåˆ†å‰²æ•°ç»„çš„ä»£ç æœ‰ä¸€ç‚¹é•¿ï¼Œæ‰€ä»¥æŠŠè¿™éƒ¨åˆ†ä»£ç æ”¾ç½®åœ¨åä¸º `split` çš„ç‹¬ç«‹çš„å‡½æ•°ä¸­ã€‚

```c
/* Sorts an array of integers using Quicksort algorithm */
#include <stdio.h>

#define N 10

void quicksort(int a[], int low, int high);
int split(int a[], int low, int high);

int main(void)
{
	int a[N], i;
	
	printf("Enter %d numbers to be sorted: ", N);
	for (i = 0; i < N; i++)
		scanf("%d", &a[i]);
	
	quicksort(a, 0, N - 1);
	
	printf("In sorted order: ");
	for (i = 0; i < N; i++)
		printf("%d ", a[i]);
	printf("\n");
	
	return 0;
}

void quicksort (int a[], int low, int high)
{
	int middle;
	
	if (low >= high) return;
	middle = split(a, low, high);
	quicksort(a, low, middle - 1);
	quicksort(a, middle + 1, high);
}

int split(int a[], int low, int high)
{
	int part_element = a[low];
	
	for (;;) {
		while (low < high && part_element <= a[high])
			high--;
		if (low >= high) break;
		a[low++] = a[high];
		
		while (low < high && a[low] <= part_element)
			low++;
		if (low >= high) break;
		a[high--] = a[low];
	}
	
	a[high] = part_element;
	return high;
}
```

è™½ç„¶æ­¤ç‰ˆæœ¬çš„å¿«é€Ÿæ’åºå¯è¡Œï¼Œä½†å®ƒä¸æ˜¯æœ€å¥½çš„ã€‚æœ‰è®¸å¤šæ–¹æ³•å¯ä»¥ç”¨æ¥æ”¹è¿›è¿™ä¸ªç¨‹åºçš„æ€§èƒ½ã€‚
- æ”¹è¿›åˆ†å‰²ç®—æ³•ã€‚ä¸Šé¢ä»‹ç»çš„æ–¹æ³•ä¸æ˜¯æœ€æœ‰æ•ˆçš„ã€‚æˆ‘ä»¬ä¸å†é€‰æ‹©æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä½œä¸ºåˆ†å‰²å…ƒç´ ã€‚æ›´å¥½çš„æ–¹æ³•æ˜¯å–ç¬¬ä¸€ä¸ªå…ƒç´ ã€ä¸­é—´å…ƒç´ å’Œæœ€åä¸€ä¸ªå…ƒç´ çš„ä¸­é—´å€¼ã€‚åˆ†å‰²è¿‡ç¨‹æœ¬èº«ä¹Ÿå¯ä»¥åŠ é€Ÿã€‚ç‰¹åˆ«æ˜¯åœ¨ä¸¤ä¸ª `while` å¾ªç¯ä¸­é¿å…æµ‹è¯• `low < high` æ˜¯å¯èƒ½çš„ã€‚
- é‡‡ç”¨ä¸åŒçš„æ–¹æ³•è¿›è¡Œå°æ•°ç»„æ’åºã€‚ä¸å†é€’å½’åœ°ä½¿ç”¨å¿«é€Ÿæ’åºæ³•ï¼Œç”¨ä¸€ä¸ªå…ƒç´ ä»å¤´åˆ°å°¾åœ°æ£€æŸ¥æ•°ç»„ã€‚é’ˆå¯¹å°æ•°ç»„ï¼ˆæ¯”å¦‚å…ƒç´ æ•°é‡å°‘äº 25 ä¸ªçš„æ•°ç»„ï¼‰æ›´å¥½çš„æ–¹æ³•æ˜¯é‡‡ç”¨è¾ƒä¸ºç®€å•çš„æ–¹æ³•ã€‚
- ä½¿å¾—å¿«é€Ÿæ’åºéé€’å½’ã€‚è™½ç„¶å¿«é€Ÿæ’åºæœ¬è´¨ä¸Šæ˜¯é€’å½’ç®—æ³•ï¼Œå¹¶ä¸”é€’å½’æ ¼å¼çš„å¿«é€Ÿæ’åºæ˜¯æœ€å®¹æ˜“ç†è§£çš„ï¼Œä½†æ˜¯å®é™…ä¸Šè‹¥å»æ‰é€’å½’ä¼šæ›´é«˜æ•ˆã€‚

æ”¹è¿›å¿«é€Ÿæ’åºçš„ç»†èŠ‚å¯ä»¥å‚è€ƒç®—æ³•è®¾è®¡æ–¹é¢çš„ä¹¦ï¼Œå¦‚ Robert Sedgewick çš„ã€Šç®—æ³•ï¼šC è¯­è¨€å®ç°ï¼ˆç¬¬ 1~4 éƒ¨åˆ†ï¼‰åŸºç¡€çŸ¥è¯†ã€æ•°æ®ç»“æ„ã€æ’åºåŠæœç´¢ï¼ˆåŸä¹¦ç¬¬ 3 ç‰ˆï¼‰ã€‹ã€‚

# æ³›å‹é€‰æ‹©ï¼ˆC1Xï¼‰ #æœªç†è§£ 

æœ‰æ—¶å€™ä½ å¯èƒ½å¸Œæœ›ç”¨åŒä¸€ä¸ªåå­—ç¼–å†™å¥½å‡ ä¸ªå‡½æ•°ï¼Œå› ä¸ºå®ƒä»¬å®ç°ç±»ä¼¼çš„åŠŸèƒ½ï¼Œåªæ˜¯å‚æ•°å’Œè¿”å›ç±»å‹ä¸åŒã€‚è¿™åœ¨å…¶ä»–ä¸€äº›é«˜çº§è¯­è¨€ï¼ˆæ¯”å¦‚ C++ï¼‰é‡Œå¾ˆå®¹æ˜“ï¼Œå› ä¸ºå®ƒä»¬æä¾›å‡½æ•°é‡è½½ï¼Œä½† C è¯­è¨€ä¸æ”¯æŒè¿™ç§åšæ³•ã€‚

å®é™…ä¸Šï¼ŒC æ ‡å‡†åº“å·²ç»ç”¨äº†è¿™ç§æ‰‹æ®µã€‚ä» C99 å¼€å§‹ï¼ŒC æ ‡å‡†åº“ç”¨æ³›å‹å®ï¼ˆ 27.5 èŠ‚ï¼‰æ¥ç»Ÿä¸€æ•°å­¦å‡½æ•°çš„å„ä¸ªç‰ˆæœ¬ã€‚æ¯”å¦‚å¯¹äºæ­£å¼¦å‡½æ•°ï¼Œä¸ºäº†åº”å¯¹ `double`ã€`float`ã€`long double`ã€`double _Complex`ã€`float _Complex` å’Œ `long double _Complex` è¿™äº›ç±»å‹çš„å‚æ•°ï¼Œæ ‡å‡†åº“å®šä¹‰äº†ç›¸åº”çš„å‡½æ•°ï¼š`sin`ã€`sinf`ã€`sinl`ã€`csin`ã€`csinf` å’Œ `csinl`ã€‚æœ‰äº†æ³›å‹å®ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨ `sin` æ¥è°ƒç”¨å®ƒä»¬è€Œä¸å¿…å…³å¿ƒè°ƒç”¨çš„å®é™…ä¸Šæ˜¯å“ªä¸ªç‰ˆæœ¬ï¼Œå› ä¸ºæ³›å‹å®å¯ä»¥æ ¹æ®æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°æ‰¾åˆ°å¯¹åº”çš„ç‰ˆæœ¬ã€‚

é—®é¢˜åœ¨äºï¼Œè™½ç„¶ C99 çš„æ ‡å‡†åº“ä½¿ç”¨äº†è¿™é¡¹æŠ€æœ¯ï¼Œä½†å¹¶æ²¡æœ‰åœ¨è¯­è¨€ï¼ˆè¯­æ³•ï¼‰å±‚é¢ä¸Šæä¾›ä»»ä½•æ”¯æŒã€‚ä¸ºäº†ä»è¯­è¨€å±‚é¢ä¸Šè§£å†³è¿™ç§éœ€æ±‚ï¼Œä» C11 å¼€å§‹ï¼ŒC æ ‡å‡†å¼•å…¥äº†æ³›å‹é€‰æ‹©ï¼ˆgeneric selectionï¼‰ï¼Œ å®ƒæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå…¶è¯­æ³•ä¸º

```c
_Generic( è¡¨è¾¾å¼ , æ³›å‹å…³è”åˆ—è¡¨ )
```

è¿™é‡Œï¼Œæ³›å‹å…³è”åˆ—è¡¨ç”±ä¸€ä¸ªæˆ–å¤šä¸ªæ³›å‹å…³è”ç»„æˆï¼Œå¦‚æœæ³›å‹å…³è”å¤šäºä¸€ä¸ªï¼Œåˆ™å®ƒä»¬ä¹‹é—´ç”¨é€—å· â€œ,â€åˆ†éš”ã€‚æ³›å‹å…³è”çš„è¯­æ³•ä¸º

```c
ç±»å‹å : è¡¨è¾¾å¼
default : è¡¨è¾¾å¼
```

æ³›å‹é€‰æ‹©æ˜¯åŸºæœ¬è¡¨è¾¾å¼ï¼Œå®ƒåœ¨ç¨‹åºç¿»è¯‘æœŸé—´æ±‚å€¼ï¼Œå…¶ä¸»è¦ç›®çš„æ˜¯ä»å¤šä¸ªå¤‡é€‰çš„è¡¨è¾¾å¼ä¸­æŒ‘å‡ºä¸€ä¸ªä½œä¸ºç»“æœã€‚æ³›å‹é€‰æ‹©è¡¨è¾¾å¼çš„ç±»å‹å°±æ˜¯è¢«æŒ‘é€‰å‡ºçš„é‚£ä¸ªè¡¨è¾¾å¼çš„ç±»å‹ï¼›æ³›å‹é€‰æ‹©è¡¨è¾¾å¼çš„å€¼å–å†³äºè¢«æŒ‘é€‰å‡ºçš„é‚£ä¸ªè¡¨è¾¾å¼çš„å€¼ã€‚ä¸‹é¢é€šè¿‡ä¸€ä¸ªå®ä¾‹æ¥è§£é‡Šæ³›å‹é€‰æ‹©è¡¨è¾¾å¼çš„åŠŸèƒ½ã€‚

```c
# include <stdio.h>
# include <math.h>
# include <complex.h>

# define sin(x) _Generic(x,\
						float:sinf,\
						double:sin,\
						long double:sinl,\
						float _Complex:csinf,\
						double _Complex:csin,\
						long double _Complex:csinl)(x)
						

int main(void)
{
	printf("%f\n", sin(.5f)); // S
	
	double _Complex d = sin(.3+.5i);
	printf("%.2f%+.2f*I", creal (d), cimag (d));
	
	return 0;
}
```

åœ¨ä»¥ä¸Šä»£ç ä¸­ï¼Œæ ‡è¯†ç¬¦ `sin` è¢«å®šä¹‰ä¸ºå®ï¼Œè™½ç„¶åœ¨å¤´æ–‡ä»¶ `<math.h>` é‡Œä¹Ÿå£°æ˜äº†ä¸€ä¸ªåŒåçš„å‡½æ•°ï¼Œä½†é¢„å¤„ç†å™¨ä¼šå…ˆå°†å®ƒè¯†åˆ«ä¸ºå®åå¹¶åšå®æ›¿æ¢ã€‚å¦å¤–ï¼Œè™½ç„¶æˆ‘ä»¬åœ¨è¿™é‡Œå°†æ³›å‹é€‰æ‹©è¡¨è¾¾å¼å®šä¹‰ä¸ºå®ä½“ï¼Œä½†æ³›å‹é€‰æ‹©è¡¨è¾¾å¼å’Œå®æ²¡æœ‰ä»»ä½•å…³ç³»ï¼Œè¿™ä¸ªä¾‹å­æœ‰å…¶ç‰¹æ®Šæ€§ï¼šæˆ‘ä»¬æ˜¯å¸Œæœ›ç”¨åŒä¸€ä¸ªå®å `sin` æ¥åº”ä»˜ä¸åŒç±»å‹çš„æ“ä½œæ•°ï¼Œå¹¶ä¾é æ³›å‹é€‰æ‹©è¡¨è¾¾å¼è§£æå‡ºä¸æ­¤æ“ä½œæ•°çš„ç±»å‹ç›¸åŒ¹é…çš„åº“å‡½æ•°ã€‚

ä»¥è¯­å¥ S ä¸ºä¾‹ï¼Œåœ¨é¢„å¤„ç†æœŸé—´ï¼ŒC å®ç°å°†å…¶å±•å¼€ä¸ºï¼ˆä¸ºäº†æ–¹ä¾¿é˜…è¯»ï¼Œåˆ©ç”¨ç»­è¡Œç¬¦åšäº†å¯¹é½å¤„ç†ï¼‰

```c
printf("%f\n", _Generic(.5f, \
						float:sinf, \
						double:sin, \
						long double:sinl, \
						float _Complex:csinf, \
						double _Complex:csin, \
						long double _Complex:csinl) \
						(x));
```

åœ¨æ³›å‹é€‰æ‹©è¡¨è¾¾å¼ä¸­ï¼Œç¬¬ä¸€ä¸ªè¡¨è¾¾å¼ç§°ä¸ºæ§åˆ¶è¡¨è¾¾å¼ï¼ˆä¸Šä¾‹ä¸­çš„ `.5f` ï¼‰ï¼Œå®ƒå¹¶ä¸æ±‚å€¼ï¼ŒC å®ç°åªæå–å®ƒçš„ç±»å‹ä¿¡æ¯ã€‚æ¥ç€ï¼Œå¦‚æœæŸä¸ªæ³›å‹å…³è”ä¸­çš„ç±»å‹åå’Œæ§åˆ¶è¡¨è¾¾å¼çš„ç±»å‹å…¼å®¹ï¼ˆåŒ¹é…ï¼‰ï¼Œ åˆ™æ³›å‹é€‰æ‹©çš„ç»“æœè¡¨è¾¾å¼å°±æ˜¯è¯¥æ³›å‹å…³è”ä¸­çš„è¡¨è¾¾å¼ã€‚

åœ¨ä¸Šä¾‹ä¸­ï¼Œè¡¨è¾¾å¼ `.5f` çš„ç±»å‹æ˜¯ `float`ï¼Œåˆ™æœ€ç»ˆé€‰æ‹©çš„æ˜¯è¡¨è¾¾å¼ `sinf`ã€‚è¿™å°±æ˜¯è¯´ï¼Œåœ¨ç¨‹åºç¿»è¯‘æœŸé—´ï¼Œä¸Šè¿°è¯­å¥è¿›ä¸€æ­¥è¢«ç®€åŒ–ä¸ºä»¥ä¸‹ç­‰ä»·å½¢å¼ï¼š

```c
printf("%f\n", sinf(x));
```

æ­¤å¤–ï¼Œåœ¨åŒä¸€ä¸ªæ³›å‹é€‰æ‹©ä¸­ï¼Œä¸å…è®¸ä¸¤ä¸ªæˆ–å¤šä¸ªæ³›å‹å…³è”çš„ç±»å‹åæ‰€æŒ‡å®šçš„ç±»å‹äº’ç›¸å…¼å®¹ã€‚æ¢å¥è¯è¯´ï¼Œä¸å…è®¸æ§åˆ¶è¡¨è¾¾å¼åŒ¹é…å¤šä¸ªæ³›å‹å…³è”çš„ç±»å‹åã€‚

å¦‚æœéœ€è¦ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ª `default` æ³›å‹å…³è”ã€‚å®ƒçš„ä»·å€¼åœ¨äºï¼Œå¦‚æœæ§åˆ¶è¡¨è¾¾å¼çš„ç±»å‹å’Œä»»ä½•ä¸€ä¸ªæ³›å‹å…³è”çš„ç±»å‹åæ‰€æŒ‡å®šçš„ç±»å‹éƒ½ä¸å…¼å®¹ï¼ˆåŒ¹é…ï¼‰ï¼Œåˆ™è‡ªåŠ¨é€‰æ‹© `default` æ³›å‹å…³è”ä¸­çš„è¡¨è¾¾å¼ã€‚ä½†æ˜¯ï¼Œä¸€ä¸ªæ³›å‹é€‰æ‹©ä¸­åªå…è®¸æœ‰ä¸€ä¸ª `default` æ³›å‹å…³è”ã€‚

è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œæ³›å‹é€‰æ‹©ä¸èƒ½è¯†åˆ«æ•°ç»„ç±»å‹ï¼Œå› ä¸ºæ•°ç»„ç±»å‹çš„è¡¨è¾¾å¼ä¼šè¢«è½¬æ¢ä¸ºæŒ‡å‘å…¶é¦–å…ƒç´ çš„æŒ‡é’ˆã€‚

# é—®ä¸ç­”

( [[Cè¯­è¨€ç¨‹åºè®¾è®¡ï¼šç°ä»£æ–¹æ³•ï¼ˆç¬¬2ç‰ˆâ€¢ä¿®è®¢ç‰ˆï¼‰.pdf#page=184&selection=22,2,28,1&color=note|ğŸ“–]])
ä¸€äº› C è¯­è¨€ä¹¦å‡ºç°äº†é‡‡ç”¨äº†ä¸åŒäºâ€œå½¢å¼å‚æ•°â€å’Œâ€œå®é™…å‚æ•°â€çš„æœ¯è¯­ï¼Œæ˜¯å¦æœ‰æ ‡å‡†æœ¯è¯­ï¼Ÿï¼ˆp.141ï¼‰

( [[Cè¯­è¨€ç¨‹åºè®¾è®¡ï¼šç°ä»£æ–¹æ³•ï¼ˆç¬¬2ç‰ˆâ€¢ä¿®è®¢ç‰ˆï¼‰.pdf#page=184&selection=90,2,90,42&color=note|ğŸ“–]])
åœ¨ç¨‹åºçš„å½¢å¼å‚æ•°åˆ—è¡¨åè¾¹ï¼Œæˆ‘ä»¬é‡è§è¿‡æŠŠå½¢å¼å‚æ•°çš„ç±»å‹ç”¨å•ç‹¬çš„å£°æ˜è¿›è¡Œè¯´æ˜çš„ä¾‹å­ï¼š

> [!question] ä¸ºä»€ä¹ˆç¼–è¯‘å™¨å…è®¸å‡½æ•°ååé¢ä¸è·Ÿç€åœ†æ‹¬å·ï¼Ÿï¼ˆp.146ï¼‰
> åœ¨åé¢æŸä¸€ç« ä¸­ä¼šçœ‹åˆ°ï¼Œç¼–è¯‘å™¨æŠŠåé¢ä¸è·Ÿåœ†æ‹¬å·çš„å‡½æ•°åçœ‹ä½œæŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆï¼ˆ 17.7 èŠ‚ï¼‰ã€‚æŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆæœ‰åˆæ³•çš„åº”ç”¨ï¼Œå› æ­¤ç¼–è¯‘å™¨ä¸èƒ½è‡ªåŠ¨å‡å®šå‡½æ•°åä¸å¸¦åœ†æ‹¬å·æ˜¯é”™è¯¯çš„ã€‚

> [!question] åœ¨å‡½æ•°è°ƒç”¨ `f (a, b)` ä¸­ï¼Œç¼–è¯‘å™¨å¦‚ä½•çŸ¥é“é€—å·æ˜¯æ ‡ç‚¹ç¬¦å·è¿˜æ˜¯è¿ç®—ç¬¦å‘¢ï¼Ÿ
> å‡½æ•°è°ƒç”¨ä¸­çš„å®é™…å‚æ•°ä¸èƒ½æ˜¯ä»»æ„çš„è¡¨è¾¾å¼ï¼Œè€Œå¿…é¡»æ˜¯æ ‡å‡†æ–‡æ¡£ä¸­ï¼Œä½äºèµ‹å€¼è¡¨è¾¾å¼å‰é¢çš„é‚£äº›è¡¨è¾¾å¼ï¼Œ è¿™äº›è¡¨è¾¾å¼ä¸èƒ½ç”¨é€—å·ä½œä¸ºè¿ç®—ç¬¦ï¼Œé™¤éé€—å·æ˜¯åœ¨åœ†æ‹¬å·ä¸­çš„ã€‚æ¢å¥è¯è¯´ï¼Œåœ¨å‡½æ•°è°ƒç”¨ `f (a, b)` ä¸­ï¼Œ é€—å·æ˜¯æ ‡ç‚¹ç¬¦å·ï¼›è€Œåœ¨ `f ((a, b))` ä¸­ï¼Œé€—å·æ˜¯è¿ç®—ç¬¦ã€‚

> [!question] å‡½æ•°åŸå‹ä¸­å½¢å¼å‚æ•°çš„åå­—æ˜¯å¦éœ€è¦å’Œåé¢å‡½æ•°å®šä¹‰ä¸­ç»™å‡ºçš„åå­—ç›¸åŒ¹é…ï¼Ÿï¼ˆp.148ï¼‰
> ä¸éœ€è¦ã€‚ä¸€äº›ç¨‹åºå‘˜åˆ©ç”¨è¿™ä¸€ç‰¹æ€§ï¼Œåœ¨åŸå‹ä¸­ç»™å‚æ•°ä¸€ä¸ªè¾ƒé•¿åå­—ï¼Œç„¶ååœ¨å®é™…å®šä¹‰ä¸­ä½¿ç”¨è¾ƒçŸ­çš„åå­—ã€‚æˆ–è€…ï¼Œè¯´æ³•è¯­çš„ç¨‹åºå‘˜å¯ä»¥åœ¨å‡½æ•°åŸå‹ä¸­ä½¿ç”¨è‹±è¯­åå­—ï¼Œç„¶ååœ¨å‡½æ•°å®šä¹‰ä¸­åˆ‡æ¢æˆæ›´ä¸ºç†Ÿæ‚‰çš„æ³•è¯­åå­—ã€‚

> [!question] æˆ‘å§‹ç»ˆä¸æ˜ç™½ä¸ºä»€ä¹ˆè¦æä¾›å‡½æ•°åŸå‹ã€‚åªè¦æŠŠæ‰€æœ‰å‡½æ•°çš„å®šä¹‰æ”¾ç½®åœ¨ `main` å‡½æ•°çš„å‰é¢ï¼Œä¸å°±æ²¡æœ‰é—®é¢˜äº†å—ï¼Ÿ
> é”™ã€‚é¦–å…ˆï¼Œä½ æ˜¯å‡è®¾åªæœ‰ `main` å‡½æ•°è°ƒç”¨å…¶ä»–å‡½æ•°ï¼Œå½“ç„¶è¿™æ˜¯ä¸åˆ‡å®é™…çš„ã€‚å®é™…ä¸Šï¼ŒæŸäº›å‡½æ•°ä¼šç›¸äº’è°ƒç”¨ã€‚å¦‚æœæŠŠæ‰€æœ‰çš„å‡½æ•°å®šä¹‰æ”¾åœ¨ `main` çš„å‰é¢ï¼Œå°±å¿…é¡»ä»”ç»†æ–Ÿé…Œå®ƒä»¬ä¹‹é—´çš„é¡ºåºï¼Œå› ä¸ºè°ƒç”¨æœªå®šä¹‰çš„å‡½æ•°å¯èƒ½ä¼šå¯¼è‡´å¤§é—®é¢˜ã€‚
> ç„¶è€Œï¼Œé—®é¢˜è¿˜ä¸æ­¢è¿™äº›ã€‚å‡è®¾æœ‰ä¸¤ä¸ªå‡½æ•°ç›¸äº’è°ƒç”¨ï¼ˆè¿™å¯ä¸æ˜¯åˆ»æ„æ‰¾éº»çƒ¦ï¼‰ã€‚æ— è®ºå…ˆå®šä¹‰å“ªä¸ªå‡½æ•°ï¼Œ éƒ½å°†å¯¼è‡´å¯¹æœªå®šä¹‰çš„å‡½æ•°çš„è°ƒç”¨ã€‚
> ä½†æ˜¯ï¼Œè¿˜æœ‰æ›´éº»çƒ¦çš„ï¼ä¸€æ—¦ç¨‹åºè¾¾åˆ°ä¸€å®šçš„è§„æ¨¡ï¼Œåœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­æ”¾ç½®æ‰€æœ‰çš„å‡½æ•°æ˜¯ä¸å¯è¡Œçš„ã€‚å½“é‡åˆ°è¿™ç§æƒ…å†µæ—¶ï¼Œå°±éœ€è¦å‡½æ•°åŸå‹å‘Šè¯‰ç¼–è¯‘å™¨åœ¨å…¶ä»–æ–‡ä»¶ä¸­å®šä¹‰çš„å‡½æ•°ã€‚

> [!question] æˆ‘çœ‹åˆ°æœ‰çš„å‡½æ•°å£°æ˜å¿½ç•¥äº†å½¢å¼å‚æ•°çš„å…¨éƒ¨ä¿¡æ¯ `double average();` è¿™ç§åšæ³•æ˜¯åˆæ³•çš„å—ï¼Ÿï¼ˆp.148ï¼‰
> æ˜¯çš„ã€‚è¿™ç§å£°æ˜æç¤ºç¼–è¯‘å™¨ `average` å‡½æ•°è¿”å› `double` ç±»å‹çš„å€¼ï¼Œä½†ä¸æä¾›å…³äºå‚æ•°æ•°é‡å’Œç±»å‹çš„ä»»ä½•ä¿¡æ¯ã€‚ï¼ˆç•™ä¸‹ç©ºçš„åœ†æ‹¬å·ä¸æ„å‘³ç€ `average` å‡½æ•°æ²¡æœ‰å‚æ•°ã€‚ï¼‰
> åœ¨ç»å…¸ C ä¸­ï¼Œè¿™æ˜¯å”¯ä¸€å…è®¸çš„ä¸€ç§å£°æ˜æ ¼å¼ã€‚æˆ‘ä»¬é‡‡ç”¨çš„å‡½æ•°åŸå‹æ ¼å¼æ˜¯åŒ…å«å‚æ•°ä¿¡æ¯çš„ï¼Œè¿™æ˜¯ C89 çš„æ–°ç‰¹æ€§ã€‚æ—§å¼çš„å‡½æ•°å£°æ˜è™½ç„¶è¿˜å…è®¸ä½¿ç”¨ï¼Œä½†ç°åœ¨å·²é€æ¸åºŸå¼ƒäº†ã€‚

> [!question] ä¸ºä»€ä¹ˆæœ‰çš„ç¨‹åºå‘˜åœ¨å‡½æ•°åŸå‹ä¸­æ•…æ„çœç•¥å‚æ•°åå­—ï¼Ÿä¿ç•™è¿™äº›åå­—ä¸æ˜¯æ›´æ–¹ä¾¿å—ï¼Ÿï¼ˆp.149ï¼‰
> çœç•¥åŸå‹ä¸­çš„å‚æ•°åå­—é€šå¸¸æ˜¯å‡ºäºé˜²å¾¡ç›®çš„ã€‚å¦‚æœæ°å¥½æœ‰ä¸€ä¸ªå®çš„åå­—è·Ÿå‚æ•°ä¸€æ ·ï¼Œé¢„å¤„ç†æ—¶å‚æ•°çš„åå­—ä¼šè¢«æ›¿æ¢ï¼Œä»è€Œå¯¼è‡´ç›¸åº”çš„åŸå‹è¢«ç ´åã€‚è¿™ç§æƒ…å†µåœ¨ä¸€ä¸ªäººç¼–å†™çš„å°ç¨‹åºä¸­ä¸å¤ªå¯èƒ½å‡ºç°ï¼Œ ä½†åœ¨å¾ˆå¤šäººç¼–å†™çš„å¤§å‹åº”ç”¨ç¨‹åºä¸­æ˜¯å¯èƒ½å‡ºç°çš„ã€‚

> [!question] æŠŠå‡½æ•°çš„å£°æ˜æ”¾åœ¨å¦ä¸€ä¸ªå‡½æ•°ä½“å†…æ˜¯å¦åˆæ³•ï¼Ÿ
> åˆæ³•ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼š
> ```c
> int main (void)
> {
> 	double average (double a, double b);
> 	...
> }
> ```
> `average` å‡½æ•°çš„è¿™ä¸ªå£°æ˜åªæœ‰åœ¨ `main` å‡½æ•°ä½“å†…æ˜¯æœ‰æ•ˆçš„ã€‚å¦‚æœå…¶ä»–å‡½æ•°éœ€è¦è°ƒç”¨ `average` å‡½æ•°ï¼Œé‚£ä¹ˆå®ƒä»¬æ¯ä¸€ä¸ªéƒ½éœ€è¦å£°æ˜å®ƒã€‚
> è¿™ç§åšæ³•çš„å¥½å¤„æ˜¯ä¾¿äºé˜…è¯»ç¨‹åºçš„äººå¼„æ¸…æ¥šå‡½æ•°é—´çš„è°ƒç”¨å…³ç³»ã€‚ï¼ˆåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ`main` å‡½æ•°å°†è°ƒç”¨ `average` å‡½æ•°ã€‚ï¼‰å¦å¤–ï¼Œå¦‚æœå‡ ä¸ªå‡½æ•°éœ€è¦è°ƒç”¨åŒä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆå¯èƒ½æ˜¯ä»¶éº»çƒ¦äº‹ã€‚æœ€ç³Ÿç³•çš„æƒ…å†µæ˜¯ï¼Œ åœ¨ç¨‹åºä¿®æ”¹è¿‡ç¨‹ä¸­è¯•å›¾æ·»åŠ æˆ–ç§»é™¤å£°æ˜å¯èƒ½ä¼šå¾ˆéº»çƒ¦ã€‚åŸºäºè¿™äº›åŸå› ï¼Œæœ¬ä¹¦å°†å§‹ç»ˆæŠŠå‡½æ•°å£°æ˜æ”¾åœ¨å‡½æ•°ä½“å¤–ã€‚

> [!question] å¦‚æœå‡ ä¸ªå‡½æ•°å…·æœ‰ç›¸åŒçš„è¿”å›ç±»å‹ï¼Œèƒ½å¦æŠŠå®ƒä»¬çš„å£°æ˜åˆå¹¶ï¼Ÿä¾‹å¦‚ï¼Œæ—¢ç„¶ `print_pun` å‡½æ•°å’Œ `print_count` å‡½æ•°éƒ½å…·æœ‰ `void` å‹çš„è¿”å›ç±»å‹ï¼Œé‚£ä¹ˆä¸‹é¢çš„å£°æ˜åˆæ³•å—ï¼Ÿ`void print_pun(void), print_count(int n);`
> åˆæ³•ã€‚äº‹å®ä¸Šï¼ŒC è¯­è¨€ç”šè‡³å…è®¸æŠŠå‡½æ•°å£°æ˜å’Œå˜é‡å£°æ˜åˆå¹¶åœ¨ä¸€èµ·ï¼š
> ```c
> double x, y, average(double a, double b);
> ```
> ä½†æ˜¯ï¼Œæ­¤ç§æ–¹å¼çš„åˆå¹¶å£°æ˜é€šå¸¸ä¸æ˜¯ä¸ªå¥½æ–¹æ³•ï¼Œå®ƒå¯èƒ½ä¼šä½¿ç¨‹åºæ˜¾å¾—æœ‰ç‚¹æ··ä¹±ã€‚

> [!question] å¦‚æœæŒ‡å®šä¸€ç»´æ•°ç»„å‹å½¢å¼å‚æ•°çš„é•¿åº¦ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿï¼ˆp.151ï¼‰
> ç¼–è¯‘å™¨ä¼šå¿½ç•¥é•¿åº¦å€¼ã€‚æ€è€ƒä¸‹é¢çš„ä¾‹å­ï¼š
> ```c
> double inner_product (double v[3], double w[3]);
> ```
> é™¤äº†æ³¨æ˜ `inner_product` å‡½æ•°çš„å‚æ•°åº”è¯¥æ˜¯é•¿åº¦ä¸º 3 çš„æ•°ç»„ä»¥å¤–ï¼ŒæŒ‡å®šé•¿åº¦å¹¶ä¸ä¼šå¸¦æ¥ä»€ä¹ˆå…¶ä»–å¥½å¤„ã€‚ç¼–è¯‘å™¨ä¸ä¼šæ£€æŸ¥å‚æ•°å®é™…ä¸Šçš„é•¿åº¦æ˜¯å¦ä¸º 3ï¼Œæ‰€ä»¥ä¸ä¼šå¢åŠ å®‰å…¨æ€§ã€‚äº‹å®ä¸Šï¼Œè¿™ç§åšæ³•ä¼šäº§ç”Ÿè¯¯å¯¼ï¼Œå› ä¸ºè¿™ç§å†™æ³•æš—ç¤ºåªèƒ½æŠŠé•¿åº¦ä¸º 3 çš„æ•°ç»„ä¼ é€’ç»™ `inner_product` å‡½æ•°ï¼Œä½†å®é™…ä¸Šå¯ä»¥ä¼ é€’ä»»æ„é•¿åº¦çš„æ•°ç»„ã€‚

> [!question] ä¸ºä»€ä¹ˆä¸€äº›ç¨‹åºå‘˜æŠŠ `return` è¯­å¥ä¸­çš„è¡¨è¾¾å¼ç”¨åœ†æ‹¬å·æ‹¬èµ·æ¥ï¼Ÿ
> Kernighan å’Œ Ritchie å†™çš„ã€ŠC ç¨‹åºè®¾è®¡è¯­è¨€ã€‹ç¬¬ 1 ç‰ˆçš„ç¤ºä¾‹ä¸­ä¸€ç›´åœ¨ `return` è¯­å¥ä¸­æœ‰åœ†æ‹¬å·ï¼Œå°½ç®¡æœ‰æ—¶æ˜¯ä¸å¿…è¦çš„ã€‚ä¸å°‘ç¨‹åºå‘˜ï¼ˆå’Œåç»­ä¹¦çš„ä½œè€…ï¼‰ä¹Ÿé‡‡ç”¨äº†è¿™ç§ä¹ æƒ¯ã€‚å› ä¸ºè¿™ç§å†™æ³•ä¸æ˜¯å¿…éœ€çš„ï¼Œ è€Œä¸”å¯¹å¯è¯»æ€§æ²¡æœ‰ä»»ä½•å¸®åŠ©ï¼Œæ‰€ä»¥æœ¬ä¹¦ä¸ä½¿ç”¨è¿™äº›åœ†æ‹¬å·ã€‚ï¼ˆKernighan å’Œ Ritchie æ˜¾ç„¶ä¹ŸåŒæ„è¿™ä¸€ç‚¹ï¼Œ åœ¨ã€ŠC ç¨‹åºè®¾è®¡è¯­è¨€ã€‹ç¬¬ 2 ç‰ˆä¸­ï¼Œ`return` è¯­å¥å°±æ²¡æœ‰åœ†æ‹¬å·äº†ã€‚ï¼‰

> [!question] é `void` å‡½æ•°è¯•å›¾æ‰§è¡Œä¸å¸¦è¡¨è¾¾å¼çš„ `return` è¯­å¥æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ
> è¿™ä¾èµ–äº C è¯­è¨€çš„ç‰ˆæœ¬ã€‚åœ¨ C89 ä¸­ï¼Œæ‰§è¡Œä¸å¸¦è¡¨è¾¾å¼çš„é `void` è¯­å¥ä¼šå¯¼è‡´æœªå®šä¹‰çš„è¡Œä¸ºï¼ˆä½†åªé™äºç¨‹åºè¯•å›¾ä½¿ç”¨å‡½æ•°è¿”å›å€¼çš„æƒ…å†µï¼‰ã€‚åœ¨ C99 ä¸­ï¼Œè¿™æ ·çš„è¯­å¥æ˜¯ä¸åˆæ³•çš„ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚

> [!question] å¦‚ä½•é€šè¿‡æµ‹è¯• `main` çš„è¿”å›å€¼æ¥åˆ¤æ–­ç¨‹åºæ˜¯å¦æ­£å¸¸ç»ˆæ­¢ï¼Ÿï¼ˆp.156ï¼‰
> è¿™ä¾èµ–äºä½¿ç”¨çš„æ“ä½œç³»ç»Ÿã€‚è®¸å¤šæ“ä½œç³»ç»Ÿå…è®¸åœ¨ â€œæ‰¹å¤„ç†æ–‡ä»¶ â€æˆ– â€œShell è„šæœ¬â€å†…æµ‹è¯• `main` çš„è¿”å›å€¼ï¼Œè¿™ç±»æ–‡ä»¶åŒ…å«å¯ä»¥è¿è¡Œå‡ ä¸ªç¨‹åºçš„å‘½ä»¤ã€‚ä¾‹å¦‚ï¼ŒWindows æ‰¹å¤„ç†æ–‡ä»¶ä¸­çš„
> ```shell
> if errorlevel 1 å‘½ä»¤
> ```
> ä¼šå¯¼è‡´åœ¨ä¸Šä¸€ä¸ªç¨‹åºç»ˆæ­¢æ—¶çš„çŠ¶æ€ç å¤§äºç­‰äº 1 æ—¶æ‰§è¡Œå‘½ä»¤ã€‚
> åœ¨ UNIX ç³»ç»Ÿä¸­ï¼Œæ¯ç§ Shell éƒ½æœ‰è‡ªå·±æµ‹è¯•çŠ¶æ€ç çš„æ–¹æ³•ã€‚åœ¨ Bourne Shell ä¸­ï¼Œå˜é‡`$?`åŒ…å«ä¸Šä¸€ä¸ªç¨‹åºçš„è¿è¡ŒçŠ¶æ€ã€‚C Shell ä¹Ÿæœ‰ç±»ä¼¼çš„å˜é‡ï¼Œä½†æ˜¯åå­—æ˜¯`$status`ã€‚

( [[Cè¯­è¨€ç¨‹åºè®¾è®¡ï¼šç°ä»£æ–¹æ³•ï¼ˆç¬¬2ç‰ˆâ€¢ä¿®è®¢ç‰ˆï¼‰.pdf#page=187&selection=54,0,63,6&color=note|ğŸ“–]])
åœ¨ç¼–è¯‘ main å‡½æ•°æ—¶ï¼Œä¸ºä»€ä¹ˆç¼–è¯‘å™¨ä¼šäº§ç”Ÿâ€œcontrol reaches end of non-void functionâ€è¿™æ ·çš„è­¦å‘Šï¼Ÿ

( [[Cè¯­è¨€ç¨‹åºè®¾è®¡ï¼šç°ä»£æ–¹æ³•ï¼ˆç¬¬2ç‰ˆâ€¢ä¿®è®¢ç‰ˆï¼‰.pdf#page=187&selection=118,2,126,2&color=note|ğŸ“–]])
å¯¹äºå‰ä¸€ä¸ªé—®é¢˜ï¼Œä¸ºä»€ä¹ˆä¸æŠŠ main å‡½æ•°çš„è¿”å›ç±»å‹å®šä¹‰ä¸º void å‘¢ï¼Ÿ

> [!question] å¦‚æœå‡½æ•° f1 è°ƒç”¨å‡½æ•° f2ï¼Œè€Œå‡½æ•° f2 åˆè°ƒç”¨äº†å‡½æ•° f1ï¼Œè¿™æ ·åˆæ³•å—ï¼Ÿ
> æ˜¯åˆæ³•çš„ã€‚è¿™æ˜¯ä¸€ç§é—´æ¥é€’å½’çš„å½¢å¼ï¼Œå³å‡½æ•° f1 çš„ä¸€æ¬¡è°ƒç”¨å¯¼è‡´äº†å¦ä¸€æ¬¡è°ƒç”¨ã€‚ï¼ˆä½†æ˜¯å¿…é¡»ç¡®ä¿å‡½æ•° f1 å’Œå‡½æ•° f2 æœ€ç»ˆéƒ½å¯ä»¥ç»ˆæ­¢ï¼ï¼‰

# ç»ƒä¹ é¢˜

Â The following program tests theÂ `pb`Â function:

```c
#include <stdio.h>

void pb(int n);

int main(void)
{
  int n;

  printf("Enter a number: ");
  scanf("%d", &n);

  printf("Output of pb: ");
  pb(n);
  printf("\n");

  return 0;
}

void pb(int n)
{
  if (n != 0) {
    pb(n / 2);
    putchar('0' + n % 2);
  }
}
```

`pb`Â prints the binary representation of the argumentÂ `n`, assuming thatÂ `n`Â is greater than 0. (We also assume that digits have consecutive codes in the underlying character set.) For example:

```c
Enter a number: 53
Output of pb: 110101
```

A trace ofÂ `pb` 's execution would look like this:

`pb(53)`Â finds that 53 is not equal to 0, so it calls  
Â Â Â Â `pb(26)`, which finds that 26 is not equal to 0, so it calls  
Â Â Â Â Â Â `pb(13)`, which finds that 13 is not equal to 0, so it calls  
Â Â Â Â Â Â Â Â `pb(6)`, which finds that 6 is not equal to 0, so it calls  
Â Â Â Â Â Â Â Â Â Â `pb(3)`, which finds that 3 is not equal to 0, so it calls  
Â Â Â Â Â Â Â Â Â Â Â Â `pb(1)`, which finds that 1 is not equal to 0, so it calls  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â `pb(0)`, which finds that 0Â _is_Â equal to 0, so it returns,

causing

Â Â Â Â Â Â Â Â Â Â Â Â `pb(1)`Â to printÂ `1`Â and return, causing  
Â Â Â Â Â Â Â Â Â Â `pb(3)`Â to printÂ `1`Â and return, causing  
Â Â Â Â Â Â Â Â `pb(6)`Â to printÂ `0`Â and return, causing  
Â Â Â Â Â Â `pb(13)`Â to printÂ `1`Â and return, causing  
Â Â Â Â `pb(26)`Â to printÂ `0`Â and return, causing  
Â Â `pb(53)`Â to printÂ `1`Â and return.