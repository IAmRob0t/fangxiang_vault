# 前言

​	我们在《01_接口函数和参数介绍》和《02_CMSIS接口应用示例》中详细的介绍了在CMSIS中的RTOS V2的各个接口及其基本使用，本篇的目的则是将里面的接口函数和FreeRTOS本身的接口进行对比，来研究下CMSIS下的RTOS API到底做了怎样的接口封装。

# 1. 线程和任务

在CMSIS的RTOS API中，使用线程来表示FreeRTOS中的任务，创建线程即创建任务。

在FreeRTOS中有两个任务创建的函数分别用来创建动态任务和静态任务，而CMSIS的RTOS API则使用线程属性的方式，在接口中通过判断属性中是否指定栈空间来分别使用FreeRTOS的那两个创建任务的函数：

| ![](05_CMSIS与FreeRTOS API的对比\创建线程_任务.png) |
| :-------------------------------------------------: |

我们来看一下这几个函数的参数对比（按函数原型的参数排序）：

| ![](05_CMSIS与FreeRTOS API的对比\线程_任务创建函数的参数对比.png) |
| :----------------------------------------------------------: |

可以看到比较一致的都需要指定线程或者任务的入口函数，即真正运行业务代码的函数，也有参数输入可以使用，但是区别在于CMSIS将创建静态或是动态任务的那几个参数集合封装到了它的第三个参数即属性参数中，从属性成员中去判断要创建任务的优先级、是否指定栈空间来创建静态任务。

线程或者任务除了新建以外还有其它一些功能函数，我们也来看下它们的对比：

| ![](05_CMSIS与FreeRTOS API的对比\线程_任务_其他函数对比.png) |
| :----------------------------------------------------------: |

# 2. 线程标志和任务通知

线程标志和任务通知是一个功能，都是用于线程/任务间的简单通知，它们的对比和联系如图所示：

| ![](05_CMSIS与FreeRTOS API的对比\线程标志_任务通知.png) |
| :-----------------------------------------------------: |

其用法我们在《FreeRTOS快速入门》和《02_CMSIS接口应用示例》中已经写了例程示例。

# 3. 信号量

信号量较为常用函数是新建信号、获取信号和释放信号，新建信号又可以分为新建二进制信号和计数型信号，在FreeRTOS中使用了两个函数完成这两个功能，而在CMSIS中用一个函数即可创建这两种信号，我们也有例程做了示例实验，我们来看下他们的函数对比：

| ![](05_CMSIS与FreeRTOS API的对比\信号量常用函数对比.png) |
| :------------------------------------------------------: |

# 4. 互斥量

在《FreeRTOS快速入门》中我们已经学习知道，在FreeRTOS中的互斥量实质上还是由信号量去完成的，在CMSIS中也是一样的，只是将其封装成为了另一个名字的函数，我们来看下对比：

| ![](05_CMSIS与FreeRTOS API的对比\互斥量常用函数对比.png) |
| :------------------------------------------------------: |

# 5. 事件

在FreeRTOS中称作”事件组“，在CMSIS中称为”事件标志“，其功能函数对应于FreeRTOS的函数如下图所示：

| ![](05_CMSIS与FreeRTOS API的对比\事件函数对比.png) |
| :------------------------------------------------: |

# 6. 消息队列和队列

在FreeRTOS中只称作队列，而CMSIS中的函数前缀是消息队列，对应于FreeRTOS内核的函数如图所示：

| ![](05_CMSIS与FreeRTOS API的对比\队列常用函数对比.png) |
| :----------------------------------------------------: |

