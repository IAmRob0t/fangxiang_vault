# Prompt：PPT到Markdown高级转换与优化指令

请根据以下要求，将指定的 `.pptx` 文件转换为一篇结构清晰、图文并茂、格式精良且带有元数据的 Markdown 笔记。

---

### 1. 源文件

*   **PPTX 文件路径：** `"00_Inbox\04_ARM汇编模拟器VisUAL.pptx"`

---

### 2. 核心任务与流程

这是一个多步骤的自动化任务，请严格按照以下流程执行：

1.  **环境准备：**
    *   检查执行环境中是否安装了 `python-pptx` 库。如果未安装，请先执行安装。

2.  **内容提取：**
    *   **提取文本：** 编写并执行一个临时的 Python 脚本，使用 `python-pptx` 从 `.pptx` 文件中提取所有幻灯片的文本内容。
    *   **提取图片：** 在与源文件相同的目录下，创建一个名为 `attachments` 的子文件夹。编写并执行另一个 Python 脚本，将所有图片提取并保存到该文件夹中。

3.  **图片智能分析与处理：**
    *   **分析内容：** 逐一分析 `attachments` 文件夹中的每张图片，利用多模态能力生成对其核心内容（如图表、代码、流程图等）的简短文字描述。
    *   **识别重复：** 如果发现某张图片与之前已处理的图片内容完全或基本重复，则将其删除。
    *   **生成命名：** 根据图片内容描述，为其生成一个清晰、有描述性的中文文件名（例如：“ARM架构图.png”）。
    *   **执行重命名：** 将图片重命名为新生成的文件名。

4.  **附件整理与归档 (关键步骤)：**
    *   **创建子文件夹：** 在 `attachments` 文件夹内部，创建一个与最终生成的 Markdown 笔记同名的新子文件夹（例如，为 `我的笔记.md` 创建 `attachments/我的笔记/` 文件夹）。
    *   **移动图片：** 将经过上一步重命名后、且属于该笔记的所有图片文件，从 `attachments` 根目录**移动**到新建的同名子文件夹中。

5.  **生成 Markdown 笔记：**
    *   **整合内容：** 将第一步提取的文本和整理后的图片进行整合。
    *   **图文穿插：** 将图片以标准的 Markdown 语法 `![](attachments/笔记名/图片文件名.png)` 格式，插入到笔记正文中与其内容最相关的段落附近。
    *   **保存位置：** 将整合后的 Markdown 笔记保存在与源文件相同的目录下，文件名与源文件主名相同。

6.  **格式优化与元数据添加：**
    *   **添加Frontmatter：** 在笔记的最顶部，创建一个 YAML Frontmatter 区域。
        ```yaml
        ---
        tags:
          - 标签1
          - 标签2
          - 标签3
        ---
        ```
    *   **推断并添加标签：** 根据笔记的整体内容，推断出3-4个最相关的核心主题词作为标签（例如：`ARM`, `汇编`, `指令集`），并填入 Frontmatter 中。
    *   **调整标题层级：**
        1.  检查笔记全文，移除最顶部的第一个一级标题 (`#`)（如果存在）。
        2.  将所有剩余的标题等级提升一级（即 `##` 变为 `#`，`###` 变为 `##`，以此类推），确保笔记以一级标题开始。
    *   **精简与润色：** 对提取的文本进行适当的润色和精简，使其语句更通顺、连贯，同时保留所有关键信息。

7.  **清理收尾：**
    *   完成所有操作后，自动删除所有临时的 Python 脚本和文本文件，并删除原始的 `.pptx` 文件，只留下最终的 Markdown 笔记和 `attachments` 文件夹。

---

### 3. 最终交付成果

*   一篇根据上述要求优化好的 `.md` 文件。
*   一个 `attachments` 文件夹，其内部包含一个或多个以笔记名命名的子文件夹，每个子文件夹中存放着对应笔记的图片。