# PPT到Markdown高级转换与优化指令

请根据以下要求，将指定的 `.pptx` 文件转换为一篇结构清晰、图文并茂、格式精良且带有元数据的 Markdown 笔记。

---

### 1. 源文件

*   **PPTX 文件路径：** `"00_Inbox\04_ARM汇编模拟器VisUAL.pptx"`

---

### 2. 核心任务与流程

这是一个基于模块化脚本的自动化任务，通过将复杂流程分解为多个独立的 Python 脚本，实现更高程度的稳定性、可维护性和可调试性。

**工作流概览:**
整个转换过程由一个主调度脚本 `main_converter.py` 驱动，该脚本按顺序调用以下五个核心模块脚本来完成任务。每个模块的输出都作为下一个模块的输入，并通过中间的 JSON 文件进行数据传递。

---

**模块化脚本详解:**

1.  **`extract_content.py` - 内容提取模块**
    *   **输入:** `.pptx` 文件路径。
    *   **功能:**
        *   检查并创建用于存放图片的 `attachments` 根目录。
        *   遍历每一页幻灯片，提取所有文本框中的文字内容。
        *   提取幻灯片中的所有图片，并以 `slide_X_image_Y.ext` 的格式初步保存在 `attachments` 目录中。
    *   **输出:**
        *   一个 `extracted_content.json` 文件，其中包含一个结构化列表，详细记录了每张幻灯片对应的文本内容和初步保存的图片路径。

2.  **`process_images.py` - 图片处理模块**
    *   **输入:** `extracted_content.json` 文件。
    *   **功能:**
        *   **去重:** 计算每张图片的哈希值（MD5），识别并删除内容完全相同的重复图片。
        *   **智能命名 (模拟):** 尝试根据图片所在幻灯片的文本内容，为其生成一个具有描述性的中文文件名。如果找不到合适的文本，则使用 `幻灯片X的图片Y.ext` 作为备用名称。
        *   在文件系统上执行重命名操作。
    *   **输出:**
        *   一个 `processed_content.json` 文件，更新了图片路径为重命名后的新路径，并处理了重复图片引用。

3.  **`organize_attachments.py` - 附件整理模块**
    *   **输入:** `processed_content.json` 文件和原始 `.pptx` 文件名。
    *   **功能:**
        *   在 `attachments` 目录下，创建一个与 `.pptx` 文件主名相同的新子文件夹（例如 `attachments/04_ARM汇编模拟器VisUAL/`）。
        *   将所有经过重命名的图片文件从 `attachments` 根目录**移动**到上述新建的子文件夹中。
    *   **输出:**
        *   一个 `final_content.json` 文件，将图片路径更新为相对于最终 Markdown 文件的相对路径（例如 `attachments/笔记名/图片名.png`）。

4.  **`generate_markdown.py` - Markdown 生成模块**
    *   **输入:** `final_content.json` 文件和原始 `.pptx` 文件名。
    *   **功能:**
        *   根据 `final_content.json` 中的数据，开始构建 Markdown 内容。
        *   按顺序遍历每张幻灯片的数据，先添加文本内容，然后插入该幻灯片对应的所有图片的 Markdown 链接 `![](...)`。
        *   在幻灯片之间插入分隔符 `---` 以保持结构清晰。
    *   **输出:**
        *   一个初步的 `.md` 文件，文件名与 `.pptx` 文件主名相同。

5.  **`optimize_markdown.py` - 格式优化模块**
    *   **输入:** 上一步生成的 `.md` 文件。
    *   **功能:**
        *   **添加 Frontmatter:** 在笔记顶部添加 YAML Frontmatter，并根据内容推断（或预设）3-4个核心 `tags`。
        *   **调整标题层级:** 移除正文的第一个一级标题 (`#`)，并将所有后续的标题提升一级（`##` -> `#`, `###` -> `##` 等）。
        *   **精简润色:** 对文本进行基础清理，例如移除多余的空行，使格式更整洁。
    *   **输出:**
        *   覆盖并更新原始的 `.md` 文件，生成最终格式精良的笔记。

---

**收尾操作 (由 `main_converter.py` 执行):**

*   在所有步骤成功完成后，自动删除所有临时的 `.py` 脚本、`.json` 文件以及原始的 `.pptx` 文件，只留下最终的 `.md` 笔记和包含图片的 `attachments` 文件夹。

---

### 3. 最终交付成果

*   一篇根据上述要求优化好的 `.md` 文件。
*   一个 `attachments` 文件夹，其内部包含一个以笔记名命名的子文件夹，子文件夹中存放着对应笔记的图片。